{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"OneSelect API","text":"<p>Welcome to the OneSelect API documentation.</p>"},{"location":"#overview","title":"Overview","text":"<p>OneSelect is a pairwise comparison system.</p>"},{"location":"#getting-started","title":"Getting Started","text":"<ol> <li>Install dependencies: <code>poetry install</code></li> <li>Run migrations: <code>poetry run alembic upgrade head</code></li> <li>Create initial data: <code>poetry run python app/initial_data.py</code></li> <li>Run server: <code>poetry run uvicorn app.main:app --reload</code></li> </ol>"},{"location":"#documentation-structure","title":"Documentation Structure","text":"<ul> <li>Introduction - System overview and getting started</li> <li>Authentication - User authentication with username/password or Google OAuth</li> <li>Deployment Guide - Container and production deployment instructions</li> <li>API Reference - Detailed endpoint documentation with examples</li> <li>Database Schema - SQLite schema reference with tables, columns, and relationships</li> <li>Theory Background - AHP algorithm and mathematical foundations</li> <li>Appendix: API Endpoint List - Quick reference of all endpoints</li> </ul>"},{"location":"#api-documentation","title":"API Documentation","text":"<p>The API documentation is available at <code>/docs</code> or <code>/redoc</code> when the server is running.</p>"},{"location":"api/","title":"API Reference","text":"<p>Base URL: <code>/api/v1</code></p> <p>All endpoints except authentication require a valid JWT token in the <code>Authorization</code> header: <code>Bearer &lt;token&gt;</code></p>"},{"location":"api/#authentication","title":"Authentication","text":""},{"location":"api/#login","title":"Login","text":"<p><code>POST /api/v1/auth/login</code></p> <p>OAuth2 compatible token login, get an access token for future requests.</p> <p>Request Body (Form Data): *   <code>username</code> (string, required): The user's email or username. *   <code>password</code> (string, required): The user's password.</p> <p>Response (200 OK): <pre><code>{\n  \"access_token\": \"string\",\n  \"token_type\": \"bearer\"\n}\n</code></pre></p> <p>Response (401 Unauthorized): *   Invalid credentials.</p>"},{"location":"api/#test-token","title":"Test Token","text":"<p><code>POST /api/v1/auth/login/test-token</code></p> <p>Test access token. Returns the current user.</p> <p>Response (200 OK): *   Returns a User object.</p>"},{"location":"api/#register","title":"Register","text":"<p><code>POST /api/v1/auth/register</code></p> <p>Register a new user account.</p> <p>Request Body: <pre><code>{\n  \"username\": \"string\",\n  \"email\": \"string\",\n  \"password\": \"string\"\n}\n</code></pre></p> <p>Response (201 Created): *   Returns the created User object.</p> <p>Response (400 Bad Request): *   Username or email already exists.</p>"},{"location":"api/#change-password","title":"Change Password","text":"<p><code>POST /api/v1/auth/change-password</code></p> <p>Change the current user's password.</p> <p>Request Body: <pre><code>{\n  \"current_password\": \"string\",\n  \"new_password\": \"string\"\n}\n</code></pre></p> <p>Response (204 No Content): *   Password changed successfully.</p> <p>Response (400 Bad Request): *   Weak password.</p> <p>Response (401 Unauthorized): *   Wrong current password.</p>"},{"location":"api/#refresh-token","title":"Refresh Token","text":"<p><code>POST /api/v1/auth/refresh</code></p> <p>Refresh the access token without requiring the user to log in again.</p> <p>When to Use: - When your access token is about to expire or has expired - To maintain a seamless user experience without forcing re-authentication - For long-running applications or sessions that exceed the token lifetime</p> <p>Access tokens have a limited lifetime for security reasons. In this backend, access tokens expire after 30 minutes. When a token expires, API requests will return a 401 Unauthorized error. Instead of requiring users to log in again with their credentials, you can use the refresh token to obtain a new access token. This keeps your application secure while maintaining a smooth user experience.</p> <p>Best Practice: Implement token refresh logic in your client application to automatically refresh tokens before they expire (e.g., refresh at 25 minutes to provide a buffer).</p> <p>Request Body: <pre><code>{\n  \"refresh_token\": \"string\"\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"access_token\": \"string\",\n  \"refresh_token\": \"string\"\n}\n</code></pre></p> <p>Response (401 Unauthorized): *   Refresh token is invalid or expired. User must log in again.</p>"},{"location":"api/#get-current-user","title":"Get Current User","text":"<p><code>GET /api/v1/auth/me</code></p> <p>Get the current authenticated user's profile.</p> <p>Response (200 OK): *   Returns a User object.</p>"},{"location":"api/#update-profile","title":"Update Profile","text":"<p><code>PATCH /api/v1/auth/me</code></p> <p>Update the current user's profile.</p> <p>Request Body: <pre><code>{\n  \"email\": \"string\",\n  \"display_name\": \"string\",\n  \"avatar_url\": \"string\"\n}\n</code></pre></p> <p>Response (200 OK): *   Returns the updated User object.</p>"},{"location":"api/#logout","title":"Logout","text":"<p><code>POST /api/v1/auth/logout</code></p> <p>Logout the current user.</p> <p>Response (204 No Content): *   Successfully logged out.</p>"},{"location":"api/#users","title":"Users","text":""},{"location":"api/#get-users","title":"Get Users","text":"<p><code>GET /api/v1/users/</code></p> <p>Retrieve users. Requires superuser privileges.</p> <p>Parameters: *   <code>skip</code> (integer, optional, default=0): Number of records to skip. *   <code>limit</code> (integer, optional, default=100): Maximum number of records to return.</p> <p>Response (200 OK): *   List of User objects.</p> <p>Response (403 Forbidden): *   User does not have superuser privileges.</p>"},{"location":"api/#create-user","title":"Create User","text":"<p><code>POST /api/v1/users/</code></p> <p>Create new user. Requires superuser privileges.</p> <p>Request Body: <pre><code>{\n  \"username\": \"string\",\n  \"email\": \"string\",\n  \"password\": \"string\",\n  \"is_active\": true,\n  \"is_superuser\": false\n}\n</code></pre></p> <p>Response (200 OK): *   Returns the created User object.</p>"},{"location":"api/#get-current-user_1","title":"Get Current User","text":"<p><code>GET /api/v1/users/me</code></p> <p>Get current user.</p> <p>Response (200 OK): *   Returns the current User object.</p>"},{"location":"api/#update-current-user","title":"Update Current User","text":"<p><code>PUT /api/v1/users/me</code></p> <p>Update own user.</p> <p>Request Body: <pre><code>{\n  \"password\": \"string\",\n  \"username\": \"string\",\n  \"email\": \"string\"\n}\n</code></pre></p> <p>Response (200 OK): *   Returns the updated User object.</p>"},{"location":"api/#get-user-by-id","title":"Get User by ID","text":"<p><code>GET /api/v1/users/{user_id}</code></p> <p>Get a specific user by id.</p> <p>Parameters: *   <code>user_id</code> (string, required): The UUID of the user.</p> <p>Response (200 OK): *   Returns a User object.</p> <p>Response (404 Not Found): *   User not found.</p>"},{"location":"api/#update-user","title":"Update User","text":"<p><code>PUT /api/v1/users/{user_id}</code></p> <p>Update a user. Requires superuser privileges.</p> <p>Parameters: *   <code>user_id</code> (string, required): The UUID of the user.</p> <p>Request Body: <pre><code>{\n  \"username\": \"string\",\n  \"email\": \"string\",\n  \"is_active\": true,\n  \"is_superuser\": false\n}\n</code></pre></p> <p>Response (200 OK): *   Returns the updated User object.</p>"},{"location":"api/#delete-user","title":"Delete User","text":"<p><code>DELETE /api/v1/users/{user_id}</code></p> <p>Delete a user. Requires superuser privileges.</p> <p>Parameters: *   <code>user_id</code> (string, required): The UUID of the user. *   <code>transfer_to</code> (string, query, optional): UUID of user to transfer ownership to.</p> <p>Response (204 No Content): *   User deleted successfully.</p> <p>Response (404 Not Found): *   User not found.</p>"},{"location":"api/#assign-project-to-user","title":"Assign Project to User","text":"<p><code>POST /api/v1/users/{user_id}/assignments</code></p> <p>Assign a project to a user.</p> <p>Parameters: *   <code>user_id</code> (string, required): The UUID of the user.</p> <p>Request Body: <pre><code>{\n  \"project_id\": \"uuid\"\n}\n</code></pre></p> <p>Response (200 OK): *   Project assigned successfully.</p> <p>Response (404 Not Found): *   User or Project not found.</p>"},{"location":"api/#update-user-role","title":"Update User Role","text":"<p><code>PATCH /api/v1/users/{user_id}/role</code></p> <p>Update a user's role. Requires superuser privileges.</p> <p>Parameters: *   <code>user_id</code> (string, required): The UUID of the user.</p> <p>Request Body: <pre><code>{\n  \"role\": \"root\" | \"user\"\n}\n</code></pre></p> <p>Response (200 OK): *   Returns the updated User object.</p> <p>Response (403 Forbidden): *   Insufficient permissions.</p>"},{"location":"api/#get-user-projects","title":"Get User Projects","text":"<p><code>GET /api/v1/users/{user_id}/projects</code></p> <p>List all projects for a specific user.</p> <p>Parameters: *   <code>user_id</code> (string, required): The UUID of the user.</p> <p>Response (200 OK): *   List of Project objects.</p> <p>Response (403 Forbidden): *   Insufficient permissions.</p>"},{"location":"api/#projects","title":"Projects","text":""},{"location":"api/#get-projects","title":"Get Projects","text":"<p><code>GET /api/v1/projects/</code></p> <p>Retrieve projects for the current user.</p> <p>Parameters: *   <code>skip</code> (integer, optional, default=0) *   <code>limit</code> (integer, optional, default=100) *   <code>include_stats</code> (boolean, optional): When true, includes statistics for each project (feature_count, comparison_count, progress for each dimension).</p> <p>Response (200 OK): *   List of Project objects.</p> <p>When <code>include_stats=true</code>, each project includes additional fields: <pre><code>{\n  \"id\": \"uuid\",\n  \"name\": \"string\",\n  \"description\": \"string\",\n  \"created_at\": \"datetime\",\n  \"feature_count\": 10,\n  \"comparison_count\": {\n    \"complexity\": 15,\n    \"value\": 12\n  },\n  \"progress\": {\n    \"complexity\": {\n      \"progress_percent\": 75.5,\n      \"transitive_coverage\": 0.8\n    },\n    \"value\": {\n      \"progress_percent\": 60.0,\n      \"transitive_coverage\": 0.65\n    }\n  }\n}\n</code></pre></p>"},{"location":"api/#create-project","title":"Create Project","text":"<p><code>POST /api/v1/projects/</code></p> <p>Create new project.</p> <p>Request Body: <pre><code>{\n  \"name\": \"string\",\n  \"description\": \"string\",\n  \"comparison_mode\": \"binary\" | \"graded\"  // optional, default \"binary\"\n}\n</code></pre></p> <p>Comparison Modes: | Mode | Description | Use Case | |------|-------------|----------| | <code>binary</code> | Simple A vs B choices (feature_a, feature_b, tie) | Quick decisions, low cognitive load | | <code>graded</code> | 5-point scale (a_much_better, a_better, equal, b_better, b_much_better) | More expressive, 30-40% fewer comparisons needed |</p> <p>Response (201 Created): *   Returns the created Project object with <code>comparison_mode</code> field.</p> <p>Example: Creating a Graded Project <pre><code>curl -X POST \"https://api.oneselect.example.com/v1/projects/\" \\\n  -H \"Authorization: Bearer &lt;token&gt;\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\": \"My Graded Project\", \"description\": \"Using 5-point scale\", \"comparison_mode\": \"graded\"}'\n</code></pre></p>"},{"location":"api/#get-project","title":"Get Project","text":"<p><code>GET /api/v1/projects/{id}</code></p> <p>Get project by ID.</p> <p>Parameters: *   <code>id</code> (string, required): The UUID of the project.</p> <p>Response (200 OK): *   Returns a Project object.</p> <p>Response (404 Not Found): *   Project not found.</p>"},{"location":"api/#update-project","title":"Update Project","text":"<p><code>PUT /api/v1/projects/{id}</code></p> <p>Update a project.</p> <p>Parameters: *   <code>id</code> (string, required): The UUID of the project.</p> <p>Request Body: <pre><code>{\n  \"name\": \"string\",\n  \"description\": \"string\"\n}\n</code></pre></p> <p>Response (200 OK): *   Returns the updated Project object.</p>"},{"location":"api/#delete-project","title":"Delete Project","text":"<p><code>DELETE /api/v1/projects/{id}</code></p> <p>Delete a project.</p> <p>Parameters: *   <code>id</code> (string, required): The UUID of the project.</p> <p>Response (204 No Content): *   Project deleted successfully.</p>"},{"location":"api/#get-project-summary","title":"Get Project Summary","text":"<p><code>GET /api/v1/projects/{id}/summary</code></p> <p>Get a summary of project statistics and progress.</p> <p>Parameters: *   <code>id</code> (string, required): The UUID of the project.</p> <p>Response (200 OK): <pre><code>{\n  \"project\": { ...Project Object... },\n  \"feature_count\": 0,\n  \"comparison_count\": 0,\n  \"progress\": {\n    \"complexity\": 0.0,\n    \"value\": 0.0\n  }\n}\n</code></pre></p>"},{"location":"api/#get-project-collaborators","title":"Get Project Collaborators","text":"<p><code>GET /api/v1/projects/{id}/collaborators</code></p> <p>List all collaborators for a project.</p> <p>Parameters: *   <code>id</code> (string, required): The UUID of the project.</p> <p>Response (200 OK): *   List of collaborator objects with user information and roles.</p>"},{"location":"api/#get-project-activity","title":"Get Project Activity","text":"<p><code>GET /api/v1/projects/{id}/activity</code></p> <p>Get activity log for a project.</p> <p>Parameters: *   <code>id</code> (string, required): The UUID of the project. *   <code>page</code> (integer, query, optional): Page number. *   <code>per_page</code> (integer, query, optional): Items per page. *   <code>action_type</code> (string, query, optional): Filter by action type.</p> <p>Response (200 OK): <pre><code>{\n  \"items\": [\n    {\n      \"action\": \"string\",\n      \"timestamp\": \"datetime\",\n      \"user_id\": \"uuid\"\n    }\n  ],\n  \"total\": 0,\n  \"page\": 1,\n  \"per_page\": 20\n}\n</code></pre></p>"},{"location":"api/#get-last-modified","title":"Get Last Modified","text":"<p><code>GET /api/v1/projects/{id}/last-modified</code></p> <p>Get the last modification timestamp for a project.</p> <p>Parameters: *   <code>id</code> (string, required): The UUID of the project.</p> <p>Response (200 OK): <pre><code>{\n  \"last_modified\": \"datetime\",\n  \"modified_by\": \"uuid\"\n}\n</code></pre></p>"},{"location":"api/#get-comparison-history","title":"Get Comparison History","text":"<p><code>GET /api/v1/projects/{id}/history</code></p> <p>Get complete audit trail of all comparisons made in a project, including both active and deleted comparisons. This provides a full history for auditing purposes.</p> <p>Parameters: *   <code>id</code> (string, required): The UUID of the project.</p> <p>Response (200 OK): <pre><code>{\n  \"project\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\",\n    \"description\": \"string\"\n  },\n  \"comparisons\": [\n    {\n      \"id\": \"uuid\",\n      \"feature_a\": {\n        \"id\": \"uuid\",\n        \"name\": \"string\"\n      },\n      \"feature_b\": {\n        \"id\": \"uuid\",\n        \"name\": \"string\"\n      },\n      \"choice\": \"feature_a\" | \"feature_b\" | \"tie\",\n      \"dimension\": \"complexity\" | \"value\",\n      \"user\": {\n        \"id\": \"uuid\",\n        \"username\": \"string\"\n      },\n      \"created_at\": \"datetime\"\n    }\n  ],\n  \"deleted_comparisons\": [\n    {\n      \"id\": \"uuid\",\n      \"feature_a\": {\n        \"id\": \"uuid\",\n        \"name\": \"string\"\n      },\n      \"feature_b\": {\n        \"id\": \"uuid\",\n        \"name\": \"string\"\n      },\n      \"choice\": \"string\",\n      \"dimension\": \"string\",\n      \"user\": {\n        \"id\": \"uuid\",\n        \"username\": \"string\"\n      },\n      \"created_at\": \"datetime\",\n      \"deleted_at\": \"datetime\",\n      \"deleted_by\": {\n        \"id\": \"uuid\",\n        \"username\": \"string\"\n      }\n    }\n  ]\n}\n</code></pre></p> <p>Response (404 Not Found): *   Project not found.</p>"},{"location":"api/#features","title":"Features","text":"<p>All feature endpoints are nested under projects: <code>/api/v1/projects/{project_id}/features</code></p>"},{"location":"api/#get-features","title":"Get Features","text":"<p><code>GET /api/v1/projects/{project_id}/features</code></p> <p>Retrieve features for a project.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>page</code> (integer, query, optional, default=1) *   <code>per_page</code> (integer, query, optional, default=50) *   <code>search</code> (string, query, optional): Search term to filter features. *   <code>include_scores</code> (boolean, query, optional): When true, includes Bayesian scores (mu, sigma) for each feature in both dimensions.</p> <p>Response (200 OK): <pre><code>{\n  \"items\": [ ...Feature Objects... ],\n  \"total\": 0,\n  \"page\": 1,\n  \"per_page\": 50\n}\n</code></pre></p> <p>When <code>include_scores=true</code>, each feature includes additional score fields: <pre><code>{\n  \"id\": \"uuid\",\n  \"name\": \"string\",\n  \"description\": \"string\",\n  \"tags\": [\"string\"],\n  \"scores\": {\n    \"complexity\": {\n      \"mu\": 0.5,\n      \"sigma\": 1.2\n    },\n    \"value\": {\n      \"mu\": 0.8,\n      \"sigma\": 0.9\n    }\n  }\n}\n</code></pre></p>"},{"location":"api/#create-feature","title":"Create Feature","text":"<p><code>POST /api/v1/projects/{project_id}/features</code></p> <p>Create new feature in a project.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Request Body: <pre><code>{\n  \"name\": \"string\",\n  \"description\": \"string\",\n  \"tags\": [\"string\"]\n}\n</code></pre></p> <p>Response (201 Created): *   Returns the created Feature object.</p>"},{"location":"api/#bulk-create-features","title":"Bulk Create Features","text":"<p><code>POST /api/v1/projects/{project_id}/features/bulk</code></p> <p>Create multiple features at once.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Request Body: <pre><code>{\n  \"features\": [\n    {\n      \"name\": \"string\",\n      \"description\": \"string\",\n      \"tags\": [\"string\"]\n    }\n  ]\n}\n</code></pre></p> <p>Response (201 Created): <pre><code>{\n  \"count\": 0,\n  \"features\": [ ...Feature Objects... ]\n}\n</code></pre></p>"},{"location":"api/#bulk-delete-features","title":"Bulk Delete Features","text":"<p><code>POST /api/v1/projects/{project_id}/features/bulk-delete</code></p> <p>Delete multiple features at once.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Request Body: <pre><code>{\n  \"feature_ids\": [\"uuid\", \"uuid\"]\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"deleted_count\": 0\n}\n</code></pre></p>"},{"location":"api/#get-feature","title":"Get Feature","text":"<p><code>GET /api/v1/projects/{project_id}/features/{feature_id}</code></p> <p>Get feature by ID.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>feature_id</code> (string, required): The UUID of the feature.</p> <p>Response (200 OK): *   Returns a Feature object.</p> <p>Response (404 Not Found): *   Feature not found.</p>"},{"location":"api/#update-feature","title":"Update Feature","text":"<p><code>PUT /api/v1/projects/{project_id}/features/{feature_id}</code></p> <p>Update a feature.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>feature_id</code> (string, required): The UUID of the feature.</p> <p>Request Body: <pre><code>{\n  \"name\": \"string\",\n  \"description\": \"string\",\n  \"tags\": [\"string\"]\n}\n</code></pre></p> <p>Response (200 OK): *   Returns the updated Feature object.</p>"},{"location":"api/#delete-feature","title":"Delete Feature","text":"<p><code>DELETE /api/v1/projects/{project_id}/features/{feature_id}</code></p> <p>Delete a feature.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>feature_id</code> (string, required): The UUID of the feature.</p> <p>Response (204 No Content): *   Feature deleted successfully.</p>"},{"location":"api/#comparisons","title":"Comparisons","text":"<p>All comparison endpoints are nested under projects: <code>/api/v1/projects/{project_id}/comparisons</code></p>"},{"location":"api/#get-next-comparison-pair","title":"Get Next Comparison Pair","text":"<p><code>GET /api/v1/projects/{project_id}/comparisons/next</code></p> <p>Get the next pair of features to compare. This is the primary endpoint for the comparison workflow.</p> <p>The endpoint uses a chain-building algorithm that leverages transitive closure for O(N log N) efficiency. When <code>target_certainty</code> is specified, the endpoint returns 204 once the transitive coverage reaches that threshold, enabling early stopping without exhaustive comparisons.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>dimension</code> (string, query, required): One of \"complexity\", \"value\". *   <code>target_certainty</code> (number, query, optional, default=0.0): Target transitive coverage level (0.0-1.0). When set to a value &gt; 0, the endpoint returns 204 No Content once transitive coverage reaches this threshold. Common values: 0.7 (70%), 0.8 (80%), 0.9 (90%). When set to 0.0 (default), comparisons continue until all orderings are known via transitivity. *   <code>include_progress</code> (boolean, query, optional): When true, includes progress metrics in the response to avoid a separate round-trip to the progress endpoint.</p> <p>Response (200 OK): <pre><code>{\n  \"comparison_id\": \"uuid\",\n  \"feature_a\": { ...Feature Object... },\n  \"feature_b\": { ...Feature Object... },\n  \"dimension\": \"complexity\" | \"value\",\n  \"progress\": {  // Only included when include_progress=true\n    \"dimension\": \"complexity\",\n    \"target_certainty\": 0.9,\n    \"transitive_coverage\": 0.75,\n    \"effective_confidence\": 0.72,\n    \"progress_percent\": 80.0,\n    \"comparisons_done\": 15,\n    \"comparisons_remaining\": 5\n  }\n}\n</code></pre></p> <p>Response (204 No Content): *   Target certainty reached (when <code>target_certainty</code> &gt; 0 and transitive coverage \u2265 target), or *   All orderings are known via transitive inference, or *   No useful comparisons left to make.</p> <p>Usage Example: <pre><code>GET /api/v1/projects/{id}/comparisons/next?dimension=complexity&amp;target_certainty=0.9&amp;include_progress=true\n</code></pre> This requests the next comparison pair with progress metrics and will return 204 once 90% transitive coverage is achieved.</p> <p>Efficiency: With transitive closure optimization, reaching 90% certainty for N features typically requires approximately N \u00d7 log\u2082(N) comparisons per dimension, rather than the theoretical maximum of N\u00d7(N-1)/2 pairwise comparisons.</p>"},{"location":"api/#get-comparisons","title":"Get Comparisons","text":"<p><code>GET /api/v1/projects/{project_id}/comparisons</code></p> <p>Retrieve comparison history for a project.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>dimension</code> (string, query, optional): Filter by dimension. *   <code>page</code> (integer, query, optional) *   <code>per_page</code> (integer, query, optional) *   <code>ids</code> (string, query, optional): Comma-separated list of comparison UUIDs to fetch specific comparisons. When provided, pagination parameters are ignored.</p> <p>Response (200 OK): <pre><code>{\n  \"items\": [ ...Comparison Objects... ],\n  \"total\": 0,\n  \"page\": 1,\n  \"per_page\": 20\n}\n</code></pre></p> <p>Batch Fetch Example: <pre><code>GET /api/v1/projects/{id}/comparisons?ids=uuid1,uuid2,uuid3\n</code></pre> Returns only the specified comparisons for efficient bulk retrieval.</p>"},{"location":"api/#create-comparison","title":"Create Comparison","text":"<p><code>POST /api/v1/projects/{project_id}/comparisons</code></p> <p>Submit a comparison result. This endpoint performs a Bayesian update to the feature rankings and returns the comparison along with current inconsistency statistics for immediate UI feedback.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Request Body: <pre><code>{\n  \"feature_a_id\": \"uuid\",\n  \"feature_b_id\": \"uuid\",\n  \"choice\": \"feature_a\" | \"feature_b\" | \"tie\",\n  \"dimension\": \"complexity\" | \"value\"\n}\n</code></pre></p> <p>Response (201 Created): <pre><code>{\n  \"id\": \"uuid\",\n  \"project_id\": \"uuid\",\n  \"feature_a\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\"\n  },\n  \"feature_b\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\"\n  },\n  \"choice\": \"feature_a\" | \"feature_b\" | \"tie\",\n  \"dimension\": \"complexity\" | \"value\",\n  \"created_at\": \"datetime\",\n  \"inconsistency_stats\": {\n    \"cycle_count\": 0,\n    \"total_comparisons\": 0,\n    \"inconsistency_percentage\": 0.0,\n    \"dimension\": \"complexity\" | \"value\"\n  }\n}\n</code></pre></p> <p>The <code>inconsistency_stats</code> object provides immediate feedback about the health of the comparison graph, allowing UIs to display warnings when inconsistencies are detected.</p>"},{"location":"api/#create-binary-comparison","title":"Create Binary Comparison","text":"<p><code>POST /api/v1/projects/{project_id}/comparisons/binary</code></p> <p>Submit a binary comparison (A beats B, B beats A, or tie). This endpoint is for projects in binary comparison mode. For graded comparisons, use the <code>/comparisons/graded</code> endpoint.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project (must be in binary mode).</p> <p>Request Body: <pre><code>{\n  \"feature_a_id\": \"uuid\",\n  \"feature_b_id\": \"uuid\",\n  \"choice\": \"feature_a\" | \"feature_b\" | \"tie\",\n  \"dimension\": \"complexity\" | \"value\"\n}\n</code></pre></p> <p>Response (201 Created): <pre><code>{\n  \"id\": \"uuid\",\n  \"project_id\": \"uuid\",\n  \"feature_a\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\"\n  },\n  \"feature_b\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\"\n  },\n  \"choice\": \"feature_a\" | \"feature_b\" | \"tie\",\n  \"dimension\": \"complexity\" | \"value\",\n  \"created_at\": \"datetime\",\n  \"inconsistency_stats\": {\n    \"cycle_count\": 0,\n    \"total_comparisons\": 0,\n    \"inconsistency_percentage\": 0.0,\n    \"dimension\": \"complexity\" | \"value\"\n  }\n}\n</code></pre></p> <p>Response (400 Bad Request): *   If the project is in graded mode: <code>{\"detail\": \"Project is in 'graded' mode. Use the graded comparison endpoint.\"}</code></p>"},{"location":"api/#create-graded-comparison","title":"Create Graded Comparison","text":"<p><code>POST /api/v1/projects/{project_id}/comparisons/graded</code></p> <p>Submit a graded comparison using a 5-point scale. This endpoint is for projects in graded comparison mode. Graded comparisons provide more information per comparison, allowing 30-40% faster convergence with fewer total comparisons needed.</p> <p>Strength Values: | Strength | Meaning | Derived Choice | Update Multiplier | |----------|---------|----------------|-------------------| | <code>a_much_better</code> | Feature A is significantly better than B | <code>feature_a</code> | 2.0x (configurable) | | <code>a_better</code> | Feature A is better than B | <code>feature_a</code> | 1.0x | | <code>equal</code> | Features are roughly equal | <code>tie</code> | 1.0x (configurable) | | <code>b_better</code> | Feature B is better than A | <code>feature_b</code> | 1.0x | | <code>b_much_better</code> | Feature B is significantly better than A | <code>feature_b</code> | 2.0x (configurable) |</p> <p>The \"a_much_better\" and \"b_much_better\" options apply a 2.0x multiplier to the Bayesian update, causing faster convergence of scores and reduced variance. The multipliers are configurable in <code>app/core/config.py</code>: - <code>GRADED_MUCH_BETTER_MULTIPLIER</code> (default: 2.0) - for strong preferences - <code>GRADED_EQUAL_MULTIPLIER</code> (default: 1.0) - for ties; reduce if users select \"equal\" when uncertain</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project (must be in graded mode).</p> <p>Request Body: <pre><code>{\n  \"feature_a_id\": \"uuid\",\n  \"feature_b_id\": \"uuid\",\n  \"dimension\": \"complexity\" | \"value\",\n  \"strength\": \"a_much_better\" | \"a_better\" | \"equal\" | \"b_better\" | \"b_much_better\"\n}\n</code></pre></p> <p>Response (201 Created): <pre><code>{\n  \"id\": \"uuid\",\n  \"project_id\": \"uuid\",\n  \"feature_a\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\"\n  },\n  \"feature_b\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\"\n  },\n  \"dimension\": \"complexity\" | \"value\",\n  \"strength\": \"a_much_better\" | \"a_better\" | \"equal\" | \"b_better\" | \"b_much_better\",\n  \"choice\": \"feature_a\" | \"feature_b\" | \"tie\",\n  \"created_at\": \"datetime\",\n  \"inconsistency_stats\": {\n    \"cycle_count\": 0,\n    \"total_comparisons\": 0,\n    \"inconsistency_percentage\": 0.0,\n    \"dimension\": \"complexity\" | \"value\"\n  }\n}\n</code></pre></p> <p>Response (400 Bad Request): *   If the project is in binary mode: <code>{\"detail\": \"Project is in 'binary' mode. Use the binary comparison endpoint.\"}</code></p> <p>Example: Graded vs Binary Comparison Count</p> <p>For a project with 20 features: - Binary mode: ~60 comparisons to reach 90% certainty - Graded mode: ~40 comparisons to reach 90% certainty (33% reduction)</p> <p>The stronger signal from \"a_much_better\"/\"b_much_better\" judgments (2x multiplier) accelerates learning.</p>"},{"location":"api/#get-comparison-estimates","title":"Get Comparison Estimates","text":"<p><code>GET /api/v1/projects/{project_id}/comparisons/estimates</code></p> <p>Get current estimates for all features based on comparisons made.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>dimension</code> (string, query, required): One of \"complexity\", \"value\".</p> <p>Response (200 OK): <pre><code>{\n  \"dimension\": \"complexity\" | \"value\",\n  \"estimates\": [\n    {\n      \"feature_id\": \"uuid\",\n      \"estimate\": 0.0,\n      \"variance\": 0.0\n    }\n  ]\n}\n</code></pre></p>"},{"location":"api/#get-inconsistency-statistics","title":"Get Inconsistency Statistics","text":"<p><code>GET /api/v1/projects/{project_id}/comparisons/inconsistency-stats</code></p> <p>Get a summary of inconsistency statistics without detailed cycle information. This lightweight endpoint is ideal for dashboard widgets, health checks, and polling for updates.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>dimension</code> (string, query, optional): Filter by dimension (\"complexity\" or \"value\"). If omitted, returns stats for both dimensions.</p> <p>Response (200 OK): <pre><code>{\n  \"cycle_count\": 0,\n  \"total_comparisons\": 0,\n  \"inconsistency_percentage\": 0.0,\n  \"dimension\": \"complexity\" | \"value\"\n}\n</code></pre></p> <p>Use Cases: *   Dashboard widgets showing project health *   Real-time polling for inconsistency alerts *   Quick health checks without fetching full cycle details</p>"},{"location":"api/#get-inconsistencies","title":"Get Inconsistencies","text":"<p><code>GET /api/v1/projects/{project_id}/comparisons/inconsistencies</code></p> <p>Detect and return detailed information about inconsistent comparison cycles (e.g., A &gt; B &gt; C &gt; A). This endpoint performs a depth-first search on the comparison graph to identify all cycles, which represent logical inconsistencies where the transitive property of comparisons is violated.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>dimension</code> (string, query, optional): Filter by dimension (\"complexity\" or \"value\"). If omitted, detects cycles in both dimensions.</p> <p>Response (200 OK): <pre><code>{\n  \"cycles\": [\n    {\n      \"feature_ids\": [\"uuid\", \"uuid\", \"uuid\"],\n      \"feature_names\": [\"Feature A\", \"Feature B\", \"Feature C\"],\n      \"length\": 3,\n      \"dimension\": \"complexity\" | \"value\"\n    }\n  ],\n  \"count\": 0,\n  \"message\": \"Found N inconsistency cycles\"\n}\n</code></pre></p> <p>Algorithm: Uses depth-first search (DFS) with cycle detection. Time complexity: O(V + E) where V is the number of features and E is the number of comparisons. Typical performance: &lt;1ms for 70 features.</p> <p>Cycle Interpretation: A cycle like [A, B, C] means: A &gt; B &gt; C &gt; A, which is logically inconsistent. The cycle represents a sequence of comparisons where following the \"winner\" edges leads back to the starting feature.</p>"},{"location":"api/#get-resolution-pair","title":"Get Resolution Pair","text":"<p><code>GET /api/v1/projects/{project_id}/comparisons/resolve-inconsistency</code></p> <p>Get a specific pair of features to compare to resolve detected inconsistencies. Uses the \"weakest link\" strategy: identifies all cycles, examines pairs in those cycles, and suggests re-comparing the pair with the highest combined uncertainty (\u03c3_i + \u03c3_j). This approach targets the comparison most likely to be incorrect.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>dimension</code> (string, query, required): The dimension to check (\"complexity\" or \"value\").</p> <p>Response (200 OK): <pre><code>{\n  \"comparison_id\": null,\n  \"feature_a\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\",\n    \"description\": \"string\"\n  },\n  \"feature_b\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\",\n    \"description\": \"string\"\n  },\n  \"dimension\": \"complexity\" | \"value\",\n  \"reason\": \"Weakest link in cycle: highest combined uncertainty\",\n  \"combined_uncertainty\": 2.5,\n  \"cycle_context\": {\n    \"cycle_count\": 2,\n    \"features_in_cycles\": [\"Feature A\", \"Feature B\", \"Feature C\", \"Feature D\"]\n  }\n}\n</code></pre></p> <p>The <code>cycle_context</code> field provides additional information about the inconsistency state: - <code>cycle_count</code>: Total number of cycles detected in the comparison graph - <code>features_in_cycles</code>: List of unique feature names involved in any cycle, helping users understand which features have conflicting rankings</p> <p>Response (204 No Content): *   No inconsistencies detected in the specified dimension.</p> <p>Strategy: The weakest link approach assumes that pairs with high uncertainty are more likely to have incorrect comparison results. By re-comparing these pairs, users can potentially break the cycle and restore consistency to the comparison graph.</p>"},{"location":"api/#get-comparison-progress","title":"Get Comparison Progress","text":"<p><code>GET /api/v1/projects/{project_id}/comparisons/progress</code></p> <p>Get progress metrics for comparisons in a project using a hybrid confidence model that combines transitive coverage, Bayesian confidence, and consistency scoring.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>dimension</code> (string, query, required): One of \"complexity\", \"value\". *   <code>target_certainty</code> (number, query, optional, default=0.90): Target certainty level (0.0-1.0).</p> <p>Response (200 OK): <pre><code>{\n  \"dimension\": \"complexity\",\n  \"target_certainty\": 0.90,\n\n  \"transitive_coverage\": 0.85,\n  \"transitive_known_pairs\": 34,\n  \"uncertain_pairs\": 6,\n\n  \"direct_coverage\": 0.45,\n  \"unique_pairs_compared\": 18,\n  \"total_possible_pairs\": 40,\n\n  \"coverage_confidence\": 0.45,\n  \"bayesian_confidence\": 0.72,\n  \"consistency_score\": 1.0,\n  \"effective_confidence\": 0.88,\n  \"progress_percent\": 88.0,\n\n  \"total_comparisons_done\": 22,\n  \"comparisons_remaining\": 3,\n  \"theoretical_minimum\": 22,\n  \"practical_estimate\": 27,\n\n  \"current_avg_variance\": 0.28,\n  \"comparisons_done\": 22,\n  \"cycle_count\": 0\n}\n</code></pre></p> <p>Key Fields: *   <code>transitive_coverage</code>: Fraction of pairs with known ordering (0.0-1.0), including those inferred via transitivity. Primary progress metric. *   <code>effective_confidence</code>: Combined confidence score considering transitivity, Bayesian updates, and consistency. *   <code>uncertain_pairs</code>: Number of pairs whose ordering is still unknown. *   <code>theoretical_minimum</code>: Information-theoretic lower bound: \u2308log\u2082(N!)\u2309 *   <code>practical_estimate</code>: Expected comparisons needed for target: ~0.77 \u00d7 N \u00d7 log\u2082(N) for 90% target. *   <code>cycle_count</code>: Number of detected logical inconsistencies (A&gt;B&gt;C&gt;A cycles).</p>"},{"location":"api/#reset-comparisons","title":"Reset Comparisons","text":"<p><code>POST /api/v1/projects/{project_id}/comparisons/reset</code></p> <p>Reset all comparisons for a project or dimension.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Request Body: <pre><code>{\n  \"dimension\": \"complexity\" | \"value\"\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"message\": \"string\",\n  \"count\": 0\n}\n</code></pre></p>"},{"location":"api/#undo-last-comparison","title":"Undo Last Comparison","text":"<p><code>POST /api/v1/projects/{project_id}/comparisons/undo</code></p> <p>Undo the last comparison made. Returns updated progress metrics for immediate UI feedback.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Request Body: <pre><code>{\n  \"dimension\": \"complexity\" | \"value\"\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"undone_comparison_id\": \"uuid\",\n  \"message\": \"Comparison undone\",\n  \"updated_progress\": {\n    \"comparisons_done\": 14,\n    \"progress_percent\": 75.5\n  }\n}\n</code></pre></p> <p>The <code>updated_progress</code> field provides post-undo progress metrics so the UI can update without an additional API call: - <code>comparisons_done</code>: Number of comparisons remaining after undo - <code>progress_percent</code>: Current progress percentage toward target certainty</p> <p>Response (404 Not Found): *   No comparisons to undo.</p>"},{"location":"api/#skip-comparison","title":"Skip Comparison","text":"<p><code>POST /api/v1/projects/{project_id}/comparisons/skip</code></p> <p>Skip a comparison pair without recording a result.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Request Body: <pre><code>{\n  \"comparison_id\": \"uuid\"\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"status\": \"skipped\"\n}\n</code></pre></p>"},{"location":"api/#get-comparison","title":"Get Comparison","text":"<p><code>GET /api/v1/projects/{project_id}/comparisons/{comparison_id}</code></p> <p>Get comparison by ID.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>comparison_id</code> (string, required): The UUID of the comparison.</p> <p>Response (200 OK): *   Returns a Comparison object.</p>"},{"location":"api/#update-comparison","title":"Update Comparison","text":"<p><code>PUT /api/v1/projects/{project_id}/comparisons/{comparison_id}</code></p> <p>Update a comparison result.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>comparison_id</code> (string, required): The UUID of the comparison.</p> <p>Request Body: <pre><code>{\n  \"choice\": \"feature_a\" | \"feature_b\" | \"tie\"\n}\n</code></pre></p> <p>Response (200 OK): *   Returns the updated Comparison object.</p>"},{"location":"api/#delete-comparison","title":"Delete Comparison","text":"<p><code>DELETE /api/v1/projects/{project_id}/comparisons/{comparison_id}</code></p> <p>Delete a comparison.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>comparison_id</code> (string, required): The UUID of the comparison.</p> <p>Response (204 No Content): *   Comparison deleted successfully.</p>"},{"location":"api/#statistics","title":"Statistics","text":"<p>All statistics endpoints are nested under projects: <code>/api/v1/projects/{project_id}/statistics</code></p>"},{"location":"api/#get-project-statistics","title":"Get Project Statistics","text":"<p><code>GET /api/v1/projects/{project_id}/statistics</code></p> <p>Get comprehensive statistics for a project.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Response (200 OK): <pre><code>{\n  \"feature_count\": 0,\n  \"comparison_count\": 0,\n  \"dimensions\": {\n    \"complexity\": {\n      \"comparisons\": 0,\n      \"progress\": 0.0\n    },\n    \"value\": {\n      \"comparisons\": 0,\n      \"progress\": 0.0\n    }\n  }\n}\n</code></pre></p>"},{"location":"api/#get-feature-scores","title":"Get Feature Scores","text":"<p><code>GET /api/v1/projects/{project_id}/statistics/scores</code></p> <p>Get computed scores for all features in a project.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Response (200 OK): <pre><code>[\n  {\n    \"feature_id\": \"uuid\",\n    \"feature_name\": \"string\",\n    \"complexity_score\": 0.0,\n    \"value_score\": 0.0,\n    \"ratio\": 0.0\n  }\n]\n</code></pre></p>"},{"location":"api/#results","title":"Results","text":"<p>All results endpoints are nested under projects: <code>/api/v1/projects/{project_id}/results</code></p>"},{"location":"api/#get-ranked-results","title":"Get Ranked Results","text":"<p><code>GET /api/v1/projects/{project_id}/results</code></p> <p>Get ranked and scored results for all features.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>sort_by</code> (string, query, optional): One of \"complexity\", \"value\", \"ratio\". *   <code>include_quadrants</code> (boolean, query, optional): When true, includes quadrant analysis in the response.</p> <p>Response (200 OK): <pre><code>[\n  {\n    \"feature\": { ...Feature Object... },\n    \"complexity\": 0.0,\n    \"value\": 0.0,\n    \"ratio\": 0.0,\n    \"rank\": 1\n  }\n]\n</code></pre></p> <p>When <code>include_quadrants=true</code>, the response format changes to include both results and quadrant analysis: <pre><code>{\n  \"results\": [\n    {\n      \"feature\": { ...Feature Object... },\n      \"complexity\": 0.0,\n      \"value\": 0.0,\n      \"ratio\": 0.0,\n      \"rank\": 1\n    }\n  ],\n  \"quadrants\": {\n    \"quick_wins\": [ ...Feature Objects... ],\n    \"major_projects\": [ ...Feature Objects... ],\n    \"fill_ins\": [ ...Feature Objects... ],\n    \"thankless_tasks\": [ ...Feature Objects... ]\n  }\n}\n</code></pre></p> <p>This allows fetching both ranked results and quadrant categorization in a single API call.</p>"},{"location":"api/#get-quadrant-analysis","title":"Get Quadrant Analysis","text":"<p><code>GET /api/v1/projects/{project_id}/results/quadrants</code></p> <p>Get features organized into quadrants based on complexity and value.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Response (200 OK): <pre><code>{\n  \"quick_wins\": [ ...Feature Objects... ],\n  \"major_projects\": [ ...Feature Objects... ],\n  \"fill_ins\": [ ...Feature Objects... ],\n  \"thankless_tasks\": [ ...Feature Objects... ]\n}\n</code></pre></p>"},{"location":"api/#export-results","title":"Export Results","text":"<p><code>GET /api/v1/projects/{project_id}/results/export</code></p> <p>Export project results in various formats.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project. *   <code>format</code> (string, query, optional): One of \"json\", \"csv\". Default: \"json\". *   <code>sort_by</code> (string, query, optional): One of \"complexity\", \"value\", \"ratio\".</p> <p>Response (200 OK): *   Content-Type: application/json or text/csv depending on format parameter.</p>"},{"location":"api/#model-configuration","title":"Model Configuration","text":"<p>All model configuration endpoints are nested under projects: <code>/api/v1/projects/{project_id}/model-config</code></p>"},{"location":"api/#get-model-configuration","title":"Get Model Configuration","text":"<p><code>GET /api/v1/projects/{project_id}/model-config</code></p> <p>Get the current model configuration for a project.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Response (200 OK): <pre><code>{\n  \"model_type\": \"string\",\n  \"num_features\": 0,\n  \"selection_strategy\": \"string\",\n  \"dimensions\": {\n    \"complexity\": {\n      \"prior_mean\": 0.0,\n      \"prior_variance\": 1.0,\n      \"target_variance\": 0.1\n    },\n    \"value\": {\n      \"prior_mean\": 0.0,\n      \"prior_variance\": 1.0,\n      \"target_variance\": 0.1\n    }\n  }\n}\n</code></pre></p>"},{"location":"api/#update-model-configuration","title":"Update Model Configuration","text":"<p><code>PUT /api/v1/projects/{project_id}/model-config</code></p> <p>Update the model configuration for a project.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Request Body: <pre><code>{\n  \"model_type\": \"string\",\n  \"selection_strategy\": \"string\",\n  \"dimensions\": {\n    \"complexity\": {\n      \"prior_mean\": 0.0,\n      \"prior_variance\": 1.0,\n      \"target_variance\": 0.1\n    }\n  }\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"model_type\": \"string\",\n  \"num_features\": 0,\n  \"selection_strategy\": \"string\",\n  \"updated_at\": \"datetime\"\n}\n</code></pre></p> <p>Response (400 Bad Request): *   Invalid configuration parameters.</p>"},{"location":"api/#preview-configuration-impact","title":"Preview Configuration Impact","text":"<p><code>POST /api/v1/projects/{project_id}/model-config/preview</code></p> <p>Preview the impact of configuration changes without applying them.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Request Body: <pre><code>{\n  \"dimensions\": {\n    \"complexity\": {\n      \"target_variance\": 0.05\n    }\n  }\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"estimated_comparisons\": 0,\n  \"current_variance\": 0.0,\n  \"target_variance\": 0.0\n}\n</code></pre></p>"},{"location":"api/#reset-model-configuration","title":"Reset Model Configuration","text":"<p><code>POST /api/v1/projects/{project_id}/model-config/reset</code></p> <p>Reset model configuration to default values.</p> <p>Parameters: *   <code>project_id</code> (string, required): The UUID of the project.</p> <p>Response (200 OK): <pre><code>{\n  \"message\": \"Configuration reset to defaults\",\n  \"config\": { ...Config Object... }\n}\n</code></pre></p>"},{"location":"api/#admin","title":"Admin","text":"<p>All admin endpoints require superuser privileges and are prefixed with <code>/api/v1/admin</code></p>"},{"location":"api/#create-database-backup","title":"Create Database Backup","text":"<p><code>POST /api/v1/admin/database/backup</code></p> <p>Create a backup of the database.</p> <p>Response (200 OK): <pre><code>{\n  \"backup_id\": \"string\",\n  \"filename\": \"string\",\n  \"size_bytes\": 0,\n  \"created_at\": \"datetime\"\n}\n</code></pre></p>"},{"location":"api/#list-database-backups","title":"List Database Backups","text":"<p><code>GET /api/v1/admin/database/backups</code></p> <p>List all available database backups.</p> <p>Response (200 OK): <pre><code>[\n  {\n    \"backup_id\": \"string\",\n    \"filename\": \"string\",\n    \"size_bytes\": 0,\n    \"created_at\": \"datetime\"\n  }\n]\n</code></pre></p>"},{"location":"api/#download-backup","title":"Download Backup","text":"<p><code>GET /api/v1/admin/database/backups/{backup_id}</code></p> <p>Download a specific backup file.</p> <p>Parameters: *   <code>backup_id</code> (string, required): The ID of the backup.</p> <p>Response (200 OK): *   Content-Type: application/octet-stream *   Binary backup file.</p>"},{"location":"api/#restore-database","title":"Restore Database","text":"<p><code>POST /api/v1/admin/database/restore</code></p> <p>Restore database from a backup.</p> <p>Request Body: <pre><code>{\n  \"backup_id\": \"string\"\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"message\": \"Database restored\",\n  \"restored_at\": \"datetime\"\n}\n</code></pre></p> <p>Response (503 Service Unavailable): *   Service temporarily unavailable during restore.</p>"},{"location":"api/#get-database-statistics","title":"Get Database Statistics","text":"<p><code>GET /api/v1/admin/database/stats</code></p> <p>Get database statistics and health metrics.</p> <p>Response (200 OK): <pre><code>{\n  \"size_bytes\": 0,\n  \"table_counts\": {\n    \"users\": 0,\n    \"projects\": 0,\n    \"features\": 0,\n    \"comparisons\": 0\n  },\n  \"last_vacuum\": \"datetime\",\n  \"integrity_ok\": true\n}\n</code></pre></p>"},{"location":"api/#run-database-maintenance","title":"Run Database Maintenance","text":"<p><code>POST /api/v1/admin/database/maintenance</code></p> <p>Run database maintenance operations.</p> <p>Request Body: <pre><code>{\n  \"operation\": \"vacuum\" | \"integrity_check\" | \"optimize\"\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"operation\": \"string\",\n  \"status\": \"completed\",\n  \"duration_ms\": 0\n}\n</code></pre></p>"},{"location":"api/#export-database","title":"Export Database","text":"<p><code>GET /api/v1/admin/database/export</code></p> <p>Bulk export data from the database.</p> <p>Parameters: *   <code>project_id</code> (string, query, optional): Export specific project only. *   <code>format</code> (string, query, optional): One of \"json\", \"sql\". Default: \"json\".</p> <p>Response (200 OK): *   Content-Type: application/json or application/sql depending on format.</p>"},{"location":"api/#import-database","title":"Import Database","text":"<p><code>POST /api/v1/admin/database/import</code></p> <p>Bulk import data into the database.</p> <p>Request Body (multipart/form-data): *   <code>file</code> (file, required): The import file.</p> <p>Response (200 OK): <pre><code>{\n  \"status\": \"completed\",\n  \"records_imported\": 0,\n  \"errors\": []\n}\n</code></pre></p>"},{"location":"api/#data-objects","title":"Data Objects","text":""},{"location":"api/#user-object","title":"User Object","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"username\": \"string\",\n  \"email\": \"string\",\n  \"is_active\": true,\n  \"is_superuser\": false,\n  \"role\": \"user\" | \"root\",\n  \"display_name\": \"string\",\n  \"avatar_url\": \"string\"\n}\n</code></pre>"},{"location":"api/#project-object","title":"Project Object","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"name\": \"string\",\n  \"description\": \"string\",\n  \"comparison_mode\": \"binary\" | \"graded\",\n  \"created_at\": \"datetime\",\n  \"owner_id\": \"uuid\"\n}\n</code></pre>"},{"location":"api/#feature-object","title":"Feature Object","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"name\": \"string\",\n  \"description\": \"string\",\n  \"tags\": [\"string\"],\n  \"project_id\": \"uuid\",\n  \"created_at\": \"datetime\",\n  \"updated_at\": \"datetime\"\n}\n</code></pre>"},{"location":"api/#comparison-object","title":"Comparison Object","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"feature_a_id\": \"uuid\",\n  \"feature_b_id\": \"uuid\",\n  \"choice\": \"feature_a\" | \"feature_b\" | \"tie\",\n  \"strength\": \"a_much_better\" | \"a_better\" | \"equal\" | \"b_better\" | \"b_much_better\" | null,\n  \"dimension\": \"complexity\" | \"value\",\n  \"project_id\": \"uuid\",\n  \"user_id\": \"uuid\",\n  \"created_at\": \"datetime\"\n}\n</code></pre> <p>Note: The <code>strength</code> field is only populated for graded comparisons. Binary comparisons have <code>strength: null</code>.</p>"},{"location":"api/#comparisonwithstats-object","title":"ComparisonWithStats Object","text":"<p>Returned by the Create Comparison endpoint to provide immediate feedback about inconsistencies:</p> <pre><code>{\n  \"id\": \"uuid\",\n  \"project_id\": \"uuid\",\n  \"feature_a\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\"\n  },\n  \"feature_b\": {\n    \"id\": \"uuid\",\n    \"name\": \"string\"\n  },\n  \"choice\": \"feature_a\" | \"feature_b\" | \"tie\",\n  \"strength\": \"much_better\" | \"better\" | \"equal\" | \"worse\" | \"much_worse\" | null,\n  \"dimension\": \"complexity\" | \"value\",\n  \"created_at\": \"datetime\",\n  \"inconsistency_stats\": {\n    \"cycle_count\": 0,\n    \"total_comparisons\": 0,\n    \"inconsistency_percentage\": 0.0,\n    \"dimension\": \"complexity\" | \"value\"\n  }\n}\n</code></pre>"},{"location":"authentication/","title":"Authentication Guide","text":"<p>OneSelect supports two authentication methods:</p> <ol> <li>Username/Password Authentication - Traditional local authentication</li> <li>Google OAuth - Sign in with your Google account</li> </ol>"},{"location":"authentication/#authentication-methods","title":"Authentication Methods","text":""},{"location":"authentication/#1-usernamepassword-authentication","title":"1. Username/Password Authentication","text":"<p>Traditional authentication where users register with a username and password.</p>"},{"location":"authentication/#registration","title":"Registration","text":"<p>Endpoint: <code>POST /api/v1/auth/register</code></p> <p>Request Body: <pre><code>{\n  \"username\": \"john_doe\",\n  \"email\": \"john@example.com\",\n  \"password\": \"SecurePassword123!\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174000\",\n  \"username\": \"john_doe\",\n  \"email\": \"john@example.com\",\n  \"is_active\": true,\n  \"is_superuser\": false,\n  \"auth_provider\": \"local\"\n}\n</code></pre></p>"},{"location":"authentication/#login","title":"Login","text":"<p>Endpoint: <code>POST /api/v1/auth/login</code></p> <p>Request Body (Form Data): <pre><code>username=john_doe\npassword=SecurePassword123!\n</code></pre></p> <p>Response: <pre><code>{\n  \"access_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"token_type\": \"bearer\"\n}\n</code></pre></p>"},{"location":"authentication/#change-password","title":"Change Password","text":"<p>Endpoint: <code>POST /api/v1/auth/change-password</code></p> <p>Headers: <pre><code>Authorization: Bearer &lt;access_token&gt;\n</code></pre></p> <p>Request Body: <pre><code>{\n  \"current_password\": \"OldPassword123!\",\n  \"new_password\": \"NewPassword123!\"\n}\n</code></pre></p> <p>Response: <code>204 No Content</code></p>"},{"location":"authentication/#2-google-oauth-authentication","title":"2. Google OAuth Authentication","text":"<p>Sign in using your Google account. No password management required.</p>"},{"location":"authentication/#how-it-works","title":"How It Works","text":"<ol> <li>User clicks \"Sign in with Google\" button</li> <li>User is redirected to Google's login page</li> <li>User authorizes the application</li> <li>Google redirects back with user information</li> <li>OneSelect creates/updates user account and issues JWT token</li> </ol>"},{"location":"authentication/#integration-flow","title":"Integration Flow","text":"<p>Step 1: Initiate OAuth Flow</p> <p>Direct users to: <code>GET /api/v1/auth/google/login</code></p> <p>This will redirect to Google's OAuth consent screen.</p> <p>Step 2: Handle Callback</p> <p>Google will redirect to: <code>GET /api/v1/auth/google/callback</code></p> <p>The backend will: - Verify the Google token - Create a new user account if one doesn't exist - Link existing accounts by email - Issue a JWT access token - Redirect to frontend with token: <code>{FRONTEND_URL}/auth/callback?token=&lt;jwt_token&gt;</code></p>"},{"location":"authentication/#check-oauth-status","title":"Check OAuth Status","text":"<p>Endpoint: <code>GET /api/v1/auth/google/status</code></p> <p>Response: <pre><code>{\n  \"google_oauth_enabled\": true,\n  \"google_client_id_set\": true,\n  \"google_client_secret_set\": true\n}\n</code></pre></p>"},{"location":"authentication/#configuration","title":"Configuration","text":""},{"location":"authentication/#environment-variables","title":"Environment Variables","text":"<p>Create a <code>.env</code> file in the project root:</p> <pre><code># JWT Settings\nSECRET_KEY=your-secret-key-here-generate-with-openssl\nALGORITHM=HS256\nACCESS_TOKEN_EXPIRE_MINUTES=30\n\n# Google OAuth (Optional)\nGOOGLE_CLIENT_ID=your-app-id.apps.googleusercontent.com\nGOOGLE_CLIENT_SECRET=your-client-secret\nGOOGLE_REDIRECT_URI=http://localhost:8000/api/v1/auth/google/callback\nFRONTEND_URL=http://localhost:3000\n\n# Database\nSQLALCHEMY_DATABASE_URI=sqlite:///./oneselect.db\n\n# CORS Origins (comma-separated)\nBACKEND_CORS_ORIGINS=[\"http://localhost:3000\"]\n</code></pre>"},{"location":"authentication/#generate-secret-key","title":"Generate Secret Key","text":"<pre><code>openssl rand -hex 32\n</code></pre> <p>Copy the output to your <code>SECRET_KEY</code> environment variable.</p>"},{"location":"authentication/#setting-up-google-oauth","title":"Setting Up Google OAuth","text":""},{"location":"authentication/#prerequisites","title":"Prerequisites","text":"<ul> <li>Google Cloud Account</li> <li>Access to Google Cloud Console</li> </ul>"},{"location":"authentication/#step-by-step-setup","title":"Step-by-Step Setup","text":""},{"location":"authentication/#1-create-google-cloud-project","title":"1. Create Google Cloud Project","text":"<ol> <li>Go to Google Cloud Console</li> <li>Click \"Select a project\" \u2192 \"New Project\"</li> <li>Enter project name (e.g., \"OneSelect\")</li> <li>Click \"Create\"</li> </ol>"},{"location":"authentication/#2-enable-google-api","title":"2. Enable Google+ API","text":"<ol> <li>In the Google Cloud Console, navigate to \"APIs &amp; Services\" \u2192 \"Library\"</li> <li>Search for \"Google+ API\"</li> <li>Click on it and click \"Enable\"</li> </ol>"},{"location":"authentication/#3-configure-oauth-consent-screen","title":"3. Configure OAuth Consent Screen","text":"<ol> <li>Go to \"APIs &amp; Services\" \u2192 \"OAuth consent screen\"</li> <li>Select \"External\" user type</li> <li>Click \"Create\"</li> <li>Fill in the required information:</li> <li>App name: OneSelect</li> <li>User support email: Your email</li> <li>Developer contact information: Your email</li> <li>Click \"Save and Continue\"</li> <li>Skip \"Scopes\" section (click \"Save and Continue\")</li> <li>Add test users (your email) if in testing mode</li> <li>Click \"Save and Continue\"</li> </ol>"},{"location":"authentication/#4-create-oauth-20-credentials","title":"4. Create OAuth 2.0 Credentials","text":"<ol> <li>Go to \"APIs &amp; Services\" \u2192 \"Credentials\"</li> <li>Click \"Create Credentials\" \u2192 \"OAuth 2.0 Client ID\"</li> <li>Select \"Web application\"</li> <li>Enter name: \"OneSelect Backend\"</li> <li>Add Authorized redirect URIs:</li> <li>Development: <code>http://localhost:8000/api/v1/auth/google/callback</code></li> <li>Production: <code>https://yourdomain.com/api/v1/auth/google/callback</code></li> <li>Click \"Create\"</li> <li>Copy the Client ID and Client Secret - you'll need these!</li> </ol>"},{"location":"authentication/#5-update-environment-variables","title":"5. Update Environment Variables","text":"<p>Add to your <code>.env</code> file:</p> <pre><code>GOOGLE_CLIENT_ID=123456789-abcdefg.apps.googleusercontent.com\nGOOGLE_CLIENT_SECRET=GOCSPX-abc123def456\nGOOGLE_REDIRECT_URI=http://localhost:8000/api/v1/auth/google/callback\nFRONTEND_URL=http://localhost:3000\n</code></pre>"},{"location":"authentication/#6-apply-database-migration","title":"6. Apply Database Migration","text":"<p>Run the migration to add OAuth fields to the User table:</p> <pre><code>poetry run alembic upgrade head\n</code></pre>"},{"location":"authentication/#7-restart-the-server","title":"7. Restart the Server","text":"<pre><code>poetry run uvicorn app.main:app --reload\n</code></pre>"},{"location":"authentication/#user-model","title":"User Model","text":"<p>Users in the system have the following attributes:</p> Field Type Description <code>id</code> UUID Unique user identifier <code>username</code> String Unique username <code>email</code> String User email (unique) <code>hashed_password</code> String Hashed password (null for OAuth users) <code>is_active</code> Boolean Account status <code>is_superuser</code> Boolean Admin privileges <code>role</code> String User role (\"user\" or \"root\") <code>display_name</code> String Display name <code>avatar_url</code> String Profile picture URL <code>google_id</code> String Google user ID (OAuth) <code>auth_provider</code> String \"local\" or \"google\""},{"location":"authentication/#account-linking","title":"Account Linking","text":"<p>If a user with the same email exists:</p> <ul> <li>Local account exists \u2192 Google OAuth will link the account and update <code>google_id</code></li> <li>Google account exists \u2192 Cannot link another provider</li> <li>No account exists \u2192 New account is created</li> </ul>"},{"location":"authentication/#making-authenticated-requests","title":"Making Authenticated Requests","text":"<p>After login (either method), include the JWT token in requests:</p> <pre><code>curl -H \"Authorization: Bearer &lt;access_token&gt;\" \\\n  http://localhost:8000/api/v1/users/me\n</code></pre>"},{"location":"authentication/#frontend-example-javascript","title":"Frontend Example (JavaScript)","text":"<pre><code>// Store token after login\nlocalStorage.setItem('access_token', token);\n\n// Make authenticated request\nfetch('http://localhost:8000/api/v1/users/me', {\n  headers: {\n    'Authorization': `Bearer ${localStorage.getItem('access_token')}`\n  }\n})\n.then(response =&gt; response.json())\n.then(data =&gt; console.log(data));\n</code></pre>"},{"location":"authentication/#admin-access","title":"Admin Access","text":""},{"location":"authentication/#creating-the-first-superuser","title":"Creating the First Superuser","text":"<p>The first superuser (admin) is automatically created when the application starts:</p> <p>Default Credentials: - Username: <code>admin@example.com</code> - Password: <code>admin</code></p> <p>\u26a0\ufe0f Change these immediately in production!</p>"},{"location":"authentication/#manually-creating-a-superuser","title":"Manually Creating a Superuser","text":"<p>Use the database directly or create an endpoint to promote users:</p> <pre><code>UPDATE users \nSET is_superuser = 1, role = 'root' \nWHERE username = 'desired_admin_username';\n</code></pre>"},{"location":"authentication/#checking-user-permissions","title":"Checking User Permissions","text":"<pre><code>from app.api.deps import get_current_active_superuser\n\n@router.get(\"/admin-only\")\ndef admin_route(\n    current_user: User = Depends(get_current_active_superuser)\n):\n    # Only accessible by superusers\n    return {\"message\": \"Admin access granted\"}\n</code></pre>"},{"location":"authentication/#security-best-practices","title":"Security Best Practices","text":""},{"location":"authentication/#1-production-configuration","title":"1. Production Configuration","text":"<ul> <li>Change <code>SECRET_KEY</code> - Generate a new one for production</li> <li>Use HTTPS - Always use SSL/TLS in production</li> <li>Secure CORS - Limit <code>BACKEND_CORS_ORIGINS</code> to your frontend domain</li> <li>Change default admin password immediately</li> </ul>"},{"location":"authentication/#2-password-requirements","title":"2. Password Requirements","text":"<p>Passwords must: - Be at least 8 characters long (recommended: 12+) - Include uppercase and lowercase letters - Include numbers - Include special characters</p>"},{"location":"authentication/#3-token-expiration","title":"3. Token Expiration","text":"<p>Tokens expire after 30 minutes by default. Adjust via:</p> <pre><code>ACCESS_TOKEN_EXPIRE_MINUTES=60\n</code></pre>"},{"location":"authentication/#4-rate-limiting","title":"4. Rate Limiting","text":"<p>Consider implementing rate limiting for login endpoints to prevent brute force attacks.</p>"},{"location":"authentication/#troubleshooting","title":"Troubleshooting","text":""},{"location":"authentication/#google-oauth-not-working","title":"Google OAuth Not Working","text":"<p>Check Configuration:</p> <pre><code>curl http://localhost:8000/api/v1/auth/google/status\n</code></pre> <p>Common Issues:</p> <ol> <li>Invalid redirect URI</li> <li>Ensure redirect URI in Google Console matches exactly</li> <li> <p>Include port number (e.g., <code>:8000</code>)</p> </li> <li> <p>Client ID/Secret not set</p> </li> <li>Verify <code>.env</code> file is loaded</li> <li> <p>Check environment variables are set correctly</p> </li> <li> <p>CORS errors</p> </li> <li>Add frontend URL to <code>BACKEND_CORS_ORIGINS</code></li> </ol>"},{"location":"authentication/#login-failures","title":"Login Failures","text":"<ol> <li>\"Incorrect email or password\"</li> <li>Verify credentials</li> <li>Check user exists in database</li> <li> <p>OAuth users cannot login with password</p> </li> <li> <p>\"Inactive user\"</p> </li> <li>User account is disabled</li> <li> <p>Check <code>is_active</code> field in database</p> </li> <li> <p>Token expired</p> </li> <li>Request a new token by logging in again</li> <li>Implement refresh token logic if needed</li> </ol>"},{"location":"authentication/#testing-authentication","title":"Testing Authentication","text":""},{"location":"authentication/#test-usernamepassword-login","title":"Test Username/Password Login","text":"<pre><code># Register\ncurl -X POST http://localhost:8000/api/v1/auth/register \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"username\": \"testuser\",\n    \"email\": \"test@example.com\",\n    \"password\": \"TestPass123!\"\n  }'\n\n# Login\ncurl -X POST http://localhost:8000/api/v1/auth/login \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"username=testuser&amp;password=TestPass123!\"\n</code></pre>"},{"location":"authentication/#test-google-oauth","title":"Test Google OAuth","text":"<ol> <li>Start the server: <code>poetry run uvicorn app.main:app --reload</code></li> <li>Visit: <code>http://localhost:8000/api/v1/auth/google/login</code></li> <li>Login with your Google account</li> <li>You'll be redirected to frontend with token</li> </ol>"},{"location":"authentication/#api-reference","title":"API Reference","text":""},{"location":"authentication/#authentication-endpoints","title":"Authentication Endpoints","text":"Method Endpoint Description Auth Required POST <code>/api/v1/auth/register</code> Register new user No POST <code>/api/v1/auth/login</code> Login with username/password No POST <code>/api/v1/auth/change-password</code> Change password Yes GET <code>/api/v1/auth/google/login</code> Initiate Google OAuth No GET <code>/api/v1/auth/google/callback</code> Google OAuth callback No GET <code>/api/v1/auth/google/status</code> Check OAuth config No POST <code>/api/v1/auth/login/test-token</code> Verify token Yes"},{"location":"authentication/#migration-guide","title":"Migration Guide","text":""},{"location":"authentication/#existing-installations","title":"Existing Installations","text":"<p>If you have an existing installation, follow these steps:</p> <ol> <li> <p>Backup your database <pre><code>cp oneselect.db oneselect.db.backup\n</code></pre></p> </li> <li> <p>Update dependencies <pre><code>poetry lock\npoetry install\n</code></pre></p> </li> <li> <p>Run migrations <pre><code>poetry run alembic upgrade head\n</code></pre></p> </li> <li> <p>Add OAuth configuration (optional)</p> </li> <li>Add Google OAuth credentials to <code>.env</code></li> <li>Restart the server</li> </ol> <p>Existing users with passwords will continue to work. They can also link their Google account by logging in with Google using the same email.</p>"},{"location":"authentication/#support","title":"Support","text":"<p>For issues or questions: - GitHub: https://github.com/johan162/oneselect - Documentation: https://johan162.github.io/oneselect</p>"},{"location":"database_schema/","title":"Database Schema","text":"<p>OneSelect uses SQLite as its database backend. The schema is managed through Alembic migrations and consists of four main tables for managing users, projects, features, and comparisons.</p>"},{"location":"database_schema/#overview","title":"Overview","text":"<p>The database schema supports: - User authentication (local and OAuth) - Multi-project organization - Bayesian scoring for features in two dimensions (complexity and value) - Binary and graded comparison modes - Soft deletion for comparisons (audit trail)</p>"},{"location":"database_schema/#database-initialization-process","title":"Database Initialization Process","text":"<p>OneSelect uses a manual initialization approach that requires explicit setup before first use. The database is not automatically created when the application starts - this provides better control over schema management and prevents accidental database creation in production environments.</p> <p>How It Works:</p> <ol> <li>Schema Creation (Alembic Migrations)</li> <li>The database schema is defined in SQLAlchemy models (<code>app/models/</code>)</li> <li>Alembic migrations in <code>alembic/versions/</code> contain the SQL operations to create tables</li> <li>Running <code>poetry run alembic upgrade head</code> executes all migrations and creates the database file</li> <li>If the database file doesn't exist, Alembic creates it and applies all migrations from scratch</li> <li> <p>If the database exists, Alembic only applies new migrations that haven't been run yet</p> </li> <li> <p>Initial Data Population</p> </li> <li>After schema creation, <code>app/initial_data.py</code> creates the default admin user</li> <li>The script checks if an admin user already exists to avoid duplicates</li> <li> <p>This is a separate step because schema and seed data have different lifecycles</p> </li> <li> <p>First-Time Setup Workflow</p> </li> </ol> <p>Local Development: <pre><code># 1. Install dependencies\npoetry install\n\n# 2. Create database schema (creates oneselect.db if it doesn't exist)\npoetry run alembic upgrade head\n\n# 3. Create admin user\npoetry run python app/initial_data.py\n\n# 4. Start the application\npoetry run uvicorn app.main:app --reload\n</code></pre></p> <p>Docker/Container Deployment: <pre><code># 1. Build container image\nmake container-build\n\n# 2. Start services (database is created in /app/data/oneselect.db volume)\nmake container-up\n\n# 3. Run migrations inside container\npodman exec oneselect-backend poetry run alembic upgrade head\n\n# 4. Create admin user inside container\npodman exec oneselect-backend poetry run python app/initial_data.py\n</code></pre></p> <p>Note: Container deployments may use an entrypoint script to automate steps 3-4 on first launch.</p> <ol> <li>Application Behavior Without Database</li> <li>If you start the application (<code>uvicorn app.main:app</code>) without creating the database first, API requests will fail with database connection errors</li> <li>The application does not automatically run migrations on startup</li> <li> <p>This design prevents accidental schema changes in production</p> </li> <li> <p>Detecting Database State</p> </li> <li>No database file: Alembic will create a new SQLite file when running <code>upgrade head</code></li> <li>Database exists, no schema: Alembic creates the <code>alembic_version</code> table and applies all migrations</li> <li>Database exists with old schema: Alembic reads <code>alembic_version</code>, determines which migrations are pending, and applies only those</li> <li> <p>Database fully up-to-date: Alembic reports \"No migrations to apply\"</p> </li> <li> <p>Zero-Downtime Updates <pre><code># Check current version\npoetry run alembic current\n\n# View pending migrations\npoetry run alembic history --indicate-current\n\n# Apply new migrations (application can stay running with SQLite)\npoetry run alembic upgrade head\n</code></pre></p> </li> </ol> <p>Why Manual Initialization?</p> <ul> <li>Safety: Prevents accidental database creation or schema changes in production</li> <li>Control: Explicit migration step makes schema changes visible in deployment pipelines</li> <li>Flexibility: Allows dry-run testing with <code>alembic upgrade head --sql</code></li> <li>Audit Trail: Clear record of when and how the database was initialized</li> <li>Zero-Trust: Application never assumes database structure - migrations must be run explicitly</li> </ul> <p>Default Credentials (created by <code>app/initial_data.py</code>): - Username: <code>admin</code> - Password: <code>admin</code> (configurable via <code>FIRST_SUPERUSER_PASSWORD</code> environment variable) - Email: <code>admin@example.com</code> (configurable via <code>FIRST_SUPERUSER</code> environment variable)</p>"},{"location":"database_schema/#entity-relationship-diagram","title":"Entity Relationship Diagram","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    users    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u2502 owner_id\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  projects   \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  features    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                       \u2502\n       \u2502                       \u2502\n       \u2502 project_id            \u2502 feature_a_id\n       \u2502                       \u2502 feature_b_id\n       \u25bc                       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502       comparisons            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"database_schema/#tables","title":"Tables","text":""},{"location":"database_schema/#users","title":"users","text":"<p>Stores user accounts with support for local authentication and Google OAuth.</p> Column Type Nullable Default Description <code>id</code> STRING (UUID) NO - Primary key <code>username</code> STRING NO - Unique username (used for login) <code>email</code> STRING YES - User email (unique) <code>hashed_password</code> STRING YES - Bcrypt hashed password (NULL for OAuth users) <code>is_active</code> BOOLEAN YES <code>1</code> Account active status <code>is_superuser</code> BOOLEAN YES <code>0</code> Admin privileges flag <code>role</code> STRING YES <code>'user'</code> User role (<code>'user'</code> or <code>'root'</code>) <code>display_name</code> STRING YES - Optional display name <code>avatar_url</code> STRING YES - URL to user avatar image <code>google_id</code> STRING YES - Google OAuth user ID (unique) <code>auth_provider</code> STRING YES <code>'local'</code> Authentication provider (<code>'local'</code> or <code>'google'</code>) <p>Indexes: - Primary key on <code>id</code> - Unique index on <code>username</code> - Unique index on <code>email</code> - Unique index on <code>google_id</code></p> <p>Notes: - OAuth users have <code>auth_provider='google'</code>, <code>google_id</code> set, and <code>hashed_password</code> NULL - Local users have <code>auth_provider='local'</code> and <code>hashed_password</code> set</p>"},{"location":"database_schema/#projects","title":"projects","text":"<p>Stores projects that contain features to be compared.</p> Column Type Nullable Default Description <code>id</code> STRING (UUID) NO - Primary key <code>name</code> STRING NO - Project name <code>description</code> STRING YES - Project description <code>created_at</code> DATETIME(TZ) YES <code>CURRENT_TIMESTAMP</code> Creation timestamp <code>owner_id</code> STRING (UUID) NO - Foreign key to <code>users.id</code> <code>total_comparisons</code> INTEGER NO <code>0</code> Total number of comparisons made <code>complexity_avg_variance</code> FLOAT NO <code>1.0</code> Average variance across complexity scores <code>value_avg_variance</code> FLOAT NO <code>1.0</code> Average variance across value scores <code>comparison_mode</code> STRING NO <code>'binary'</code> Comparison mode (<code>'binary'</code> or <code>'graded'</code>) <p>Indexes: - Primary key on <code>id</code> - Index on <code>name</code></p> <p>Constraints: - Foreign key: <code>owner_id</code> \u2192 <code>users.id</code> - Check constraint: <code>comparison_mode IN ('binary', 'graded')</code></p> <p>Notes: - <code>comparison_mode='binary'</code>: Simple A vs B vs Tie comparisons - <code>comparison_mode='graded'</code>: 5-point scale (a_much_better, a_better, equal, b_better, b_much_better)</p>"},{"location":"database_schema/#features","title":"features","text":"<p>Stores features/requirements to be compared within a project.</p> Column Type Nullable Default Description <code>id</code> STRING (UUID) NO - Primary key <code>name</code> STRING NO - Feature name <code>description</code> STRING YES - Feature description <code>project_id</code> STRING (UUID) NO - Foreign key to <code>projects.id</code> <code>tags</code> JSON YES - Array of tag strings <code>complexity_mu</code> FLOAT NO <code>0.0</code> Bayesian mean score for complexity dimension <code>complexity_sigma</code> FLOAT NO <code>1.0</code> Bayesian standard deviation for complexity <code>value_mu</code> FLOAT NO <code>0.0</code> Bayesian mean score for value dimension <code>value_sigma</code> FLOAT NO <code>1.0</code> Bayesian standard deviation for value <code>created_at</code> DATETIME(TZ) YES <code>CURRENT_TIMESTAMP</code> Creation timestamp <code>updated_at</code> DATETIME(TZ) YES - Last update timestamp <p>Indexes: - Primary key on <code>id</code> - Index on <code>name</code></p> <p>Constraints: - Foreign key: <code>project_id</code> \u2192 <code>projects.id</code></p> <p>Notes: - Bayesian scores: <code>mu</code> represents the estimated score, <code>sigma</code> represents uncertainty - Lower <code>sigma</code> = higher confidence in the score - Scores are updated after each comparison using Bradley-Terry model</p>"},{"location":"database_schema/#comparisons","title":"comparisons","text":"<p>Stores pairwise comparison results between features.</p> Column Type Nullable Default Description <code>id</code> STRING (UUID) NO - Primary key <code>project_id</code> STRING (UUID) NO - Foreign key to <code>projects.id</code> <code>feature_a_id</code> STRING (UUID) NO - Foreign key to <code>features.id</code> (first feature) <code>feature_b_id</code> STRING (UUID) NO - Foreign key to <code>features.id</code> (second feature) <code>choice</code> STRING NO - Comparison result (<code>'feature_a'</code>, <code>'feature_b'</code>, or <code>'tie'</code>) <code>dimension</code> STRING NO - Comparison dimension (<code>'complexity'</code> or <code>'value'</code>) <code>strength</code> STRING YES - Graded comparison strength (NULL for binary) <code>user_id</code> STRING (UUID) YES - Foreign key to <code>users.id</code> (who made comparison) <code>created_at</code> DATETIME(TZ) YES <code>CURRENT_TIMESTAMP</code> Creation timestamp <code>deleted_at</code> DATETIME(TZ) YES - Soft deletion timestamp (NULL if active) <code>deleted_by</code> STRING (UUID) YES - Foreign key to <code>users.id</code> (who deleted) <p>Indexes: - Primary key on <code>id</code> - Composite index on <code>(project_id, dimension, deleted_at)</code> for efficient querying</p> <p>Constraints: - Foreign key: <code>project_id</code> \u2192 <code>projects.id</code> - Foreign key: <code>feature_a_id</code> \u2192 <code>features.id</code> - Foreign key: <code>feature_b_id</code> \u2192 <code>features.id</code> - Foreign key: <code>user_id</code> \u2192 <code>users.id</code> - Foreign key: <code>deleted_by</code> \u2192 <code>users.id</code> - Check constraint: <code>strength IS NULL OR strength IN ('a_much_better', 'a_better', 'equal', 'b_better', 'b_much_better')</code></p> <p>Notes: - Binary mode: <code>strength</code> is NULL, only <code>choice</code> is used - Graded mode: <code>strength</code> indicates comparison intensity, <code>choice</code> is derived from strength - Soft deletion: Comparisons are not physically deleted; <code>deleted_at</code> is set for audit trail - Strength values:   - <code>a_much_better</code>: Feature A is significantly better (2.0x Bayesian update multiplier)   - <code>a_better</code>: Feature A is better (1.0x multiplier)   - <code>equal</code>: Features are roughly equal (configurable multiplier, default 0.8x)   - <code>b_better</code>: Feature B is better (1.0x multiplier)   - <code>b_much_better</code>: Feature B is significantly better (2.0x multiplier)</p>"},{"location":"database_schema/#alembic-migrations","title":"Alembic Migrations","text":"<p>The schema is version-controlled using Alembic. The current migration is:</p> <ul> <li><code>001_init</code>: Initial schema creation with all tables</li> </ul>"},{"location":"database_schema/#running-migrations","title":"Running Migrations","text":"<pre><code># Upgrade to latest schema\npoetry run alembic upgrade head\n\n# View migration history\npoetry run alembic history\n\n# Rollback one version\npoetry run alembic downgrade -1\n</code></pre>"},{"location":"database_schema/#common-queries","title":"Common Queries","text":""},{"location":"database_schema/#get-all-features-with-scores-for-a-project","title":"Get all features with scores for a project","text":"<pre><code>SELECT \n    f.id,\n    f.name,\n    f.description,\n    ROUND(f.complexity_mu, 3) AS complexity_score,\n    ROUND(f.complexity_sigma, 3) AS complexity_confidence,\n    ROUND(f.value_mu, 3) AS value_score,\n    ROUND(f.value_sigma, 3) AS value_confidence\nFROM \n    features f\nWHERE \n    f.project_id = 'YOUR-PROJECT-ID'\nORDER BY \n    f.complexity_mu DESC;\n</code></pre>"},{"location":"database_schema/#count-active-comparisons-by-dimension","title":"Count active comparisons by dimension","text":"<pre><code>SELECT \n    dimension,\n    COUNT(*) as comparison_count\nFROM \n    comparisons\nWHERE \n    project_id = 'YOUR-PROJECT-ID'\n    AND deleted_at IS NULL\nGROUP BY \n    dimension;\n</code></pre>"},{"location":"database_schema/#find-users-with-most-comparisons","title":"Find users with most comparisons","text":"<pre><code>SELECT \n    u.username,\n    COUNT(c.id) as comparison_count\nFROM \n    users u\n    INNER JOIN comparisons c ON u.id = c.user_id\nWHERE \n    c.deleted_at IS NULL\nGROUP BY \n    u.id, u.username\nORDER BY \n    comparison_count DESC;\n</code></pre>"},{"location":"database_schema/#get-comparison-history-with-feature-names","title":"Get comparison history with feature names","text":"<pre><code>SELECT \n    c.created_at,\n    fa.name as feature_a,\n    fb.name as feature_b,\n    c.choice,\n    c.dimension,\n    c.strength,\n    u.username\nFROM \n    comparisons c\n    INNER JOIN features fa ON c.feature_a_id = fa.id\n    INNER JOIN features fb ON c.feature_b_id = fb.id\n    LEFT JOIN users u ON c.user_id = u.id\nWHERE \n    c.project_id = 'YOUR-PROJECT-ID'\n    AND c.deleted_at IS NULL\nORDER BY \n    c.created_at DESC\nLIMIT 50;\n</code></pre>"},{"location":"database_schema/#database-file-location","title":"Database File Location","text":"<p>The SQLite database file is located at: - Development: <code>./oneselect.db</code> (project root) - Docker: <code>/app/data/oneselect.db</code> (persisted in volume)</p>"},{"location":"database_schema/#backup-and-maintenance","title":"Backup and Maintenance","text":""},{"location":"database_schema/#manual-backup","title":"Manual Backup","text":"<pre><code># Create backup\nsqlite3 oneselect.db \".backup oneselect_backup_$(date +%Y%m%d).db\"\n\n# Or use cp\ncp oneselect.db oneselect_backup_$(date +%Y%m%d).db\n</code></pre>"},{"location":"database_schema/#database-size-and-integrity","title":"Database Size and Integrity","text":"<pre><code># Check database size\nls -lh oneselect.db\n\n# Run integrity check\nsqlite3 oneselect.db \"PRAGMA integrity_check;\"\n\n# Optimize database (vacuum)\nsqlite3 oneselect.db \"VACUUM;\"\n</code></pre>"},{"location":"database_schema/#performance-considerations","title":"Performance Considerations","text":"<ul> <li>Indexes: All foreign keys and frequently queried columns are indexed</li> <li>Composite Index: <code>(project_id, dimension, deleted_at)</code> on comparisons table optimizes progress queries</li> <li>Soft Deletion: <code>deleted_at IS NULL</code> filters are fast due to index</li> <li>JSON Tags: SQLite's JSON1 extension is used for feature tags (available by default in Python's sqlite3)</li> </ul>"},{"location":"database_schema/#future-schema-changes","title":"Future Schema Changes","text":"<p>Alembic supports two approaches for creating migrations: manual and automatic (autogenerate).</p>"},{"location":"database_schema/#manual-migrations","title":"Manual Migrations","text":"<p>Manual migrations require you to explicitly specify all schema changes in Python code. This is the default when you create a new migration:</p> <pre><code># Generate an empty migration template\npoetry run alembic revision -m \"add_new_column\"\n</code></pre> <p>This creates a new file in <code>alembic/versions/</code> with empty <code>upgrade()</code> and <code>downgrade()</code> functions. You must manually write the schema changes:</p> <pre><code>def upgrade() -&gt; None:\n    # Add your schema changes here\n    op.add_column('features', sa.Column('priority', sa.Integer(), nullable=True))\n    op.create_index('ix_features_priority', 'features', ['priority'])\n\ndef downgrade() -&gt; None:\n    # Add reverse operations here\n    op.drop_index('ix_features_priority', table_name='features')\n    op.drop_column('features', 'priority')\n</code></pre> <p>Pros: - Full control over migration operations - Can include data migrations and complex transformations - Explicit and clear what changes are being made</p> <p>Cons: - Tedious and error-prone for large schema changes - Easy to forget constraints or indexes - Must manually write both upgrade and downgrade operations</p>"},{"location":"database_schema/#automatic-migrations-autogenerate","title":"Automatic Migrations (Autogenerate)","text":"<p>Alembic can automatically detect schema changes by comparing your SQLAlchemy models against the current database schema:</p> <pre><code># Generate migration with automatic change detection\npoetry run alembic revision --autogenerate -m \"add_priority_field\"\n</code></pre> <p>How Autogenerate Works:</p> <ol> <li>Model Inspection: Reads your SQLAlchemy model definitions from <code>app/models/</code></li> <li>Database Inspection: Connects to the database and reads the current schema using SQLAlchemy's reflection capabilities</li> <li>Diff Generation: Compares the two schemas and generates migration operations for detected differences</li> <li>Code Generation: Creates a migration file with <code>upgrade()</code> and <code>downgrade()</code> functions</li> </ol> <p>What Autogenerate Can Detect:</p> <p>\u2705 Detected automatically: - New tables - Removed tables - New columns - Removed columns (if configured) - Column type changes - Column nullable changes - New indexes - Removed indexes</p> <p>\u26a0\ufe0f Requires manual intervention: - Column renames (appears as drop + add) - Table renames (appears as drop + add) - Changes to check constraints - Changes to column defaults in some cases - Data migrations or transformations - Complex multi-step operations</p> <p>Important Limitations:</p> <p>Autogenerate is not perfect and you should always review the generated migration file:</p> <pre><code># After running autogenerate, review the file\ncat alembic/versions/XXXX_add_priority_field.py\n\n# Edit if needed, then apply\npoetry run alembic upgrade head\n</code></pre> <p>Example Workflow:</p> <pre><code># 1. Update your model in app/models/feature.py\nclass Feature(Base):\n    # ... existing fields ...\n    priority = Column(Integer, nullable=True, index=True)  # NEW FIELD\n\n# 2. Generate migration automatically\npoetry run alembic revision --autogenerate -m \"add_feature_priority\"\n\n# 3. Review generated file (alembic/versions/XXXX_add_feature_priority.py)\n# The file will contain something like:\ndef upgrade() -&gt; None:\n    op.add_column('features', sa.Column('priority', sa.Integer(), nullable=True))\n    op.create_index(op.f('ix_features_priority'), 'features', ['priority'], unique=False)\n\ndef downgrade() -&gt; None:\n    op.drop_index(op.f('ix_features_priority'), table_name='features')\n    op.drop_column('features', 'priority')\n\n# 4. If it looks correct, apply it\npoetry run alembic upgrade head\n</code></pre>"},{"location":"database_schema/#best-practices","title":"Best Practices","text":"<ol> <li>Always Review Autogenerated Migrations: Even with autogenerate, check the generated code before applying</li> <li>Use Autogenerate for Simple Changes: Column additions, type changes, new indexes</li> <li>Use Manual for Complex Changes: Data migrations, multi-step transformations, renames</li> <li>Test Migrations: Run <code>upgrade</code> and <code>downgrade</code> in a test environment before production</li> <li>One Logical Change Per Migration: Don't combine unrelated schema changes</li> <li>Meaningful Messages: Use descriptive migration messages: <code>alembic revision -m \"add_user_avatar_support\"</code></li> </ol>"},{"location":"database_schema/#common-migration-operations","title":"Common Migration Operations","text":"<pre><code># Add a column\nop.add_column('table_name', sa.Column('column_name', sa.String(), nullable=True))\n\n# Remove a column\nop.drop_column('table_name', 'column_name')\n\n# Change column type\nop.alter_column('table_name', 'column_name', type_=sa.Integer())\n\n# Make column non-nullable (with default for existing rows)\nop.execute(\"UPDATE table_name SET column_name = 'default' WHERE column_name IS NULL\")\nop.alter_column('table_name', 'column_name', nullable=False)\n\n# Add an index\nop.create_index('ix_table_column', 'table_name', ['column_name'])\n\n# Add a foreign key\nop.create_foreign_key('fk_table_other', 'table_name', 'other_table', ['other_id'], ['id'])\n\n# Rename a column (SQLite requires table recreation)\n# For SQLite, this is complex - see Alembic docs for batch operations\n\n# Data migration example\nop.execute(\"UPDATE features SET priority = 0 WHERE priority IS NULL\")\n</code></pre>"},{"location":"database_schema/#configuration-for-autogenerate","title":"Configuration for Autogenerate","text":"<p>In <code>alembic/env.py</code>, you can configure what autogenerate detects:</p> <pre><code>context.configure(\n    connection=connection,\n    target_metadata=target_metadata,\n    compare_type=True,           # Detect column type changes\n    compare_server_default=True, # Detect default value changes\n    include_schemas=True,        # Include schema names\n)\n</code></pre>"},{"location":"database_schema/#viewing-migration-status","title":"Viewing Migration Status","text":"<pre><code># Show current version\npoetry run alembic current\n\n# Show migration history\npoetry run alembic history --verbose\n\n# Show pending migrations\npoetry run alembic history --indicate-current\n\n# Show SQL without executing\npoetry run alembic upgrade head --sql\n</code></pre>"},{"location":"deployment/","title":"Deployment Guide","text":"<p>This guide covers various deployment options for the OneSelect backend.</p>"},{"location":"deployment/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Container Deployment (Recommended)</li> <li>Local Development Deployment</li> <li>Production Deployment</li> <li>Environment Configuration</li> <li>Database Options</li> </ul>"},{"location":"deployment/#container-deployment-recommended","title":"Container Deployment (Recommended)","text":""},{"location":"deployment/#prerequisites","title":"Prerequisites","text":"<ul> <li>Podman or Docker</li> <li>podman-compose or docker-compose</li> </ul>"},{"location":"deployment/#quick-start","title":"Quick Start","text":"<ol> <li> <p>Clone the repository: <pre><code>git clone https://github.com/johan162/oneselect.git\ncd oneselect\n</code></pre></p> </li> <li> <p>Configure environment: <pre><code>cp .env.example .env\n</code></pre></p> </li> </ol> <p>Edit <code>.env</code> and set:    - <code>SECRET_KEY</code>: Generate with <code>openssl rand -hex 32</code>    - <code>FIRST_SUPERUSER</code>: Admin email    - <code>FIRST_SUPERUSER_PASSWORD</code>: Admin password</p> <ol> <li> <p>Build and run: <pre><code>make container-build\nmake container-up\n</code></pre></p> </li> <li> <p>Verify deployment: <pre><code>curl http://localhost:8000/docs\n</code></pre></p> </li> </ol>"},{"location":"deployment/#container-commands","title":"Container Commands","text":"Command Description <code>make container-build</code> Build the container image <code>make container-up</code> Start services (detached mode) <code>make container-down</code> Stop and remove containers <code>make container-logs</code> View application logs <code>make container-restart</code> Restart services <code>make container-shell</code> Access container shell <code>make container-clean</code> Remove everything (including volumes)"},{"location":"deployment/#development-mode","title":"Development Mode","text":"<p>To enable hot-reload for development, edit <code>docker-compose.yml</code> and uncomment:</p> <pre><code>volumes:\n  - ./app:/app/app:ro\ncommand: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload\n</code></pre> <p>Then restart: <pre><code>make container-restart\n</code></pre></p>"},{"location":"deployment/#local-development-deployment","title":"Local Development Deployment","text":""},{"location":"deployment/#prerequisites_1","title":"Prerequisites","text":"<ul> <li>Python 3.13+</li> <li>Poetry</li> </ul>"},{"location":"deployment/#setup","title":"Setup","text":"<ol> <li> <p>Install dependencies: <pre><code>poetry install\n</code></pre></p> </li> <li> <p>Setup database: <pre><code>poetry run alembic upgrade head\npoetry run python app/initial_data.py\n</code></pre></p> </li> <li> <p>Run server: <pre><code>poetry run uvicorn app.main:app --reload\n</code></pre></p> </li> </ol>"},{"location":"deployment/#production-deployment","title":"Production Deployment","text":""},{"location":"deployment/#cloud-platforms","title":"Cloud Platforms","text":""},{"location":"deployment/#railway","title":"Railway","text":"<ol> <li>Connect your GitHub repository to Railway</li> <li>Add environment variables in Railway dashboard</li> <li>Railway will auto-detect and deploy</li> </ol>"},{"location":"deployment/#flyio","title":"Fly.io","text":"<pre><code># Install flyctl\ncurl -L https://fly.io/install.sh | sh\n\n# Launch app\nfly launch\n\n# Deploy\nfly deploy\n</code></pre>"},{"location":"deployment/#aws-elastic-beanstalk","title":"AWS Elastic Beanstalk","text":"<pre><code># Initialize EB\neb init -p docker oneselect\n\n# Create environment\neb create oneselect-prod\n\n# Deploy\neb deploy\n</code></pre>"},{"location":"deployment/#digital-ocean-app-platform","title":"Digital Ocean App Platform","text":"<ol> <li>Connect GitHub repository</li> <li>Configure as Docker container</li> <li>Set environment variables</li> <li>Deploy</li> </ol>"},{"location":"deployment/#container-registry","title":"Container Registry","text":"<p>Push to container registry for deployment:</p> <pre><code># Build image\npodman build -t oneselect-backend:latest .\n\n# Tag for registry\npodman tag oneselect-backend:latest registry.example.com/oneselect-backend:latest\n\n# Push to registry\npodman push registry.example.com/oneselect-backend:latest\n</code></pre>"},{"location":"deployment/#environment-configuration","title":"Environment Configuration","text":""},{"location":"deployment/#required-variables","title":"Required Variables","text":"<pre><code># Security\nSECRET_KEY=your-secret-key-here\nACCESS_TOKEN_EXPIRE_MINUTES=30\n\n# Admin User\nFIRST_SUPERUSER=admin@example.com\nFIRST_SUPERUSER_PASSWORD=secure-password\n\n# Database (choose one)\nSQLALCHEMY_DATABASE_URI=sqlite:///./oneselect.db\n# SQLALCHEMY_DATABASE_URI=postgresql://user:pass@host:5432/oneselect\n# SQLALCHEMY_DATABASE_URI=mysql+pymysql://user:pass@host:3306/oneselect\n\n# CORS (adjust for your frontend)\nBACKEND_CORS_ORIGINS=[\"http://localhost:3000\"]\n</code></pre>"},{"location":"deployment/#optional-variables","title":"Optional Variables","text":"<pre><code># Application\nPROJECT_NAME=OneSelect\nAPI_V1_STR=/v1\n\n# Logging\nLOG_LEVEL=INFO\n</code></pre>"},{"location":"deployment/#generating-secret-key","title":"Generating Secret Key","text":"<pre><code># Using OpenSSL\nopenssl rand -hex 32\n\n# Using Python\npython -c \"import secrets; print(secrets.token_urlsafe(32))\"\n</code></pre>"},{"location":"deployment/#database-options","title":"Database Options","text":""},{"location":"deployment/#sqlite-default-development","title":"SQLite (Default - Development)","text":"<p>Best for development and small deployments:</p> <pre><code>SQLALCHEMY_DATABASE_URI=sqlite:///./oneselect.db\n</code></pre> <p>Pros: - No additional setup required - File-based, easy to backup - Perfect for development</p> <p>Cons: - Not suitable for high-traffic production - Limited concurrent write operations</p>"},{"location":"deployment/#postgresql-recommended-production","title":"PostgreSQL (Recommended - Production)","text":"<p>Best for production deployments:</p> <pre><code>SQLALCHEMY_DATABASE_URI=postgresql://username:password@localhost:5432/oneselect\n</code></pre> <p>Setup with Docker/Podman:</p> <p>Add to <code>docker-compose.yml</code>:</p> <pre><code>services:\n  postgres:\n    image: postgres:15\n    environment:\n      POSTGRES_DB: oneselect\n      POSTGRES_USER: oneselect\n      POSTGRES_PASSWORD: secure-password\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n    networks:\n      - oneselect-network\n\n  oneselect-api:\n    depends_on:\n      - postgres\n    environment:\n      - SQLALCHEMY_DATABASE_URI=postgresql://oneselect:secure-password@postgres:5432/oneselect\n\nvolumes:\n  postgres-data:\n</code></pre>"},{"location":"deployment/#mysqlmariadb","title":"MySQL/MariaDB","text":"<pre><code>SQLALCHEMY_DATABASE_URI=mysql+pymysql://username:password@localhost:3306/oneselect\n</code></pre>"},{"location":"deployment/#health-checks","title":"Health Checks","text":"<p>The application includes built-in health checks:</p> <ul> <li>Endpoint: <code>GET /docs</code></li> <li>Container health check: Runs every 30 seconds</li> <li>Load balancer health check: Use <code>/docs</code> endpoint</li> </ul>"},{"location":"deployment/#scaling","title":"Scaling","text":""},{"location":"deployment/#horizontal-scaling","title":"Horizontal Scaling","text":"<p>Run multiple container instances behind a load balancer:</p> <pre><code># Using podman-compose\npodman-compose up -d --scale oneselect-api=3\n</code></pre>"},{"location":"deployment/#vertical-scaling","title":"Vertical Scaling","text":"<p>Adjust container resources in <code>docker-compose.yml</code>:</p> <pre><code>services:\n  oneselect-api:\n    deploy:\n      resources:\n        limits:\n          cpus: '2'\n          memory: 2G\n        reservations:\n          cpus: '1'\n          memory: 1G\n</code></pre>"},{"location":"deployment/#monitoring","title":"Monitoring","text":""},{"location":"deployment/#application-logs","title":"Application Logs","text":"<pre><code># View logs\nmake container-logs\n\n# View specific container\npodman logs oneselect-backend -f\n</code></pre>"},{"location":"deployment/#health-check","title":"Health Check","text":"<pre><code># Check container health\npodman inspect oneselect-backend | grep Health -A 20\n\n# Test endpoint\ncurl http://localhost:8000/docs\n</code></pre>"},{"location":"deployment/#backup-and-restore","title":"Backup and Restore","text":""},{"location":"deployment/#sqlite-backup","title":"SQLite Backup","text":"<pre><code># Backup\npodman exec oneselect-backend sqlite3 /app/data/oneselect.db \".backup /app/data/backup.db\"\npodman cp oneselect-backend:/app/data/backup.db ./backup.db\n\n# Restore\npodman cp ./backup.db oneselect-backend:/app/data/oneselect.db\nmake container-restart\n</code></pre>"},{"location":"deployment/#postgresql-backup","title":"PostgreSQL Backup","text":"<pre><code># Backup\npodman exec postgres pg_dump -U oneselect oneselect &gt; backup.sql\n\n# Restore\npodman exec -i postgres psql -U oneselect oneselect &lt; backup.sql\n</code></pre>"},{"location":"deployment/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/#container-wont-start","title":"Container won't start","text":"<pre><code># Check logs\nmake container-logs\n\n# Rebuild image\nmake container-clean\nmake container-build\nmake container-up\n</code></pre>"},{"location":"deployment/#database-connection-issues","title":"Database connection issues","text":"<pre><code># Check database is accessible\npodman exec oneselect-backend env | grep DATABASE\n\n# Test connection\npodman exec oneselect-backend python -c \"from app.db.session import engine; print(engine.url)\"\n</code></pre>"},{"location":"deployment/#permission-issues","title":"Permission issues","text":"<p>If you encounter permission issues with volumes:</p> <pre><code># SELinux systems (Fedora, RHEL, CentOS)\n# Already handled with :Z flag in volume mounts\n\n# Or disable SELinux for testing (not recommended for production)\nsudo setenforce 0\n</code></pre>"},{"location":"deployment/#security-checklist","title":"Security Checklist","text":"<ul> <li>[ ] Change default <code>SECRET_KEY</code></li> <li>[ ] Change default admin password</li> <li>[ ] Use HTTPS in production (reverse proxy)</li> <li>[ ] Configure CORS origins appropriately</li> <li>[ ] Use PostgreSQL for production</li> <li>[ ] Enable container security scanning</li> <li>[ ] Set up regular backups</li> <li>[ ] Monitor application logs</li> <li>[ ] Keep dependencies updated</li> </ul>"},{"location":"deployment/#next-steps","title":"Next Steps","text":"<ul> <li>Configure reverse proxy (Nginx/Traefik) with SSL</li> <li>Set up CI/CD pipeline</li> <li>Configure monitoring (Prometheus/Grafana)</li> <li>Implement log aggregation (ELK/Loki)</li> <li>Set up automated backups</li> </ul>"},{"location":"inconsistency_detection/","title":"Inconsistency Detection","text":""},{"location":"inconsistency_detection/#overview","title":"Overview","text":"<p>OneSelect includes cycle detection to identify logical inconsistencies in pairwise comparisons. These occur when comparison chains form cycles, such as: - Feature A &gt; Feature B - Feature B &gt; Feature C - Feature C &gt; Feature A</p> <p>While the Bayesian model handles probabilistic inconsistencies naturally (through variance), detecting hard logical cycles is valuable for identifying comparison pairs that may need re-evaluation.</p>"},{"location":"inconsistency_detection/#algorithm","title":"Algorithm","text":""},{"location":"inconsistency_detection/#on-demand-cycle-detection","title":"On-Demand Cycle Detection","text":"<p>The implementation uses on-demand cycle detection with Depth-First Search (DFS):</p> <ol> <li>Graph Construction: Build a directed graph from comparisons</li> <li>Nodes = Features</li> <li>Edges = Winner \u2192 Loser relationships</li> <li> <p>Ties are excluded (no directed edge)</p> </li> <li> <p>Cycle Detection: Use DFS with recursion stack tracking</p> </li> <li>Time Complexity: O(V + E) where V = features, E = comparisons</li> <li>Space Complexity: O(V) for recursion stack</li> <li> <p>Performance: &lt; 1ms for typical 70-feature projects</p> </li> <li> <p>Cycle Normalization: Normalize cycles to prevent duplicates</p> </li> <li>Start from lexicographically smallest node</li> <li>Prevents [A,B,C] and [B,C,A] from being counted twice</li> </ol>"},{"location":"inconsistency_detection/#design-rationale","title":"Design Rationale","text":"<p>Why On-Demand? - No schema changes or migrations needed - No persistent data structures to maintain - No cache invalidation complexity - Extremely fast for expected scale (70 features, ~100-500 comparisons) - Cycles are rare in practice (Bayesian updates discourage them)</p> <p>Alternatives Considered: 1. Cached Graph Structure - Rejected: adds complexity, cache invalidation issues 2. Database Edge Table - Rejected: over-engineered, requires triggers 3. Materialized Paths - Rejected: not needed for this scale</p>"},{"location":"inconsistency_detection/#api-endpoints","title":"API Endpoints","text":""},{"location":"inconsistency_detection/#post-projectsproject_idcomparisons-enhanced","title":"POST <code>/projects/{project_id}/comparisons</code> (Enhanced)","text":"<p>Creates a comparison and returns inconsistency statistics in the response.</p> <p>Response includes: <pre><code>{\n  \"id\": \"uuid\",\n  \"project_id\": \"uuid\",\n  \"feature_a\": { /* Feature object */ },\n  \"feature_b\": { /* Feature object */ },\n  \"choice\": \"feature_a\",\n  \"dimension\": \"complexity\",\n  \"created_at\": \"2025-12-03T10:30:00Z\",\n  \"inconsistency_stats\": {\n    \"cycle_count\": 2,\n    \"total_comparisons\": 45,\n    \"inconsistency_percentage\": 8.89,\n    \"dimension\": \"complexity\"\n  }\n}\n</code></pre></p> <p>Benefits: - Single HTTP request = faster UX - Immediate feedback after user action - Guaranteed consistency (same transaction)</p>"},{"location":"inconsistency_detection/#get-projectsproject_idcomparisonsinconsistency-stats","title":"GET <code>/projects/{project_id}/comparisons/inconsistency-stats</code>","text":"<p>Get inconsistency statistics without creating a comparison.</p> <p>Use Cases: - Dashboard widgets showing inconsistency count - Polling for updates without submitting comparisons - Quick health checks of comparison quality</p> <p>Parameters: - <code>dimension</code> (optional): Filter by \"complexity\" or \"value\"</p> <p>Response: <pre><code>{\n  \"cycle_count\": 2,\n  \"total_comparisons\": 45,\n  \"inconsistency_percentage\": 8.89,\n  \"dimension\": \"complexity\"\n}\n</code></pre></p> <p>Example: <pre><code>curl -X GET \"http://localhost:8000/api/v1/projects/{id}/comparisons/inconsistency-stats?dimension=complexity\" \\\n  -H \"Authorization: Bearer {token}\"\n</code></pre></p>"},{"location":"inconsistency_detection/#get-projectsproject_idcomparisonsinconsistencies","title":"GET <code>/projects/{project_id}/comparisons/inconsistencies</code>","text":"<p>Returns detailed cycle information with feature names and IDs.</p> <p>Parameters: - <code>dimension</code> (optional): Filter by \"complexity\" or \"value\"</p> <p>Response: <pre><code>{\n  \"cycles\": [\n    {\n      \"feature_ids\": [\"uuid1\", \"uuid2\", \"uuid3\", \"uuid1\"],\n      \"feature_names\": [\"Feature A\", \"Feature B\", \"Feature C\", \"Feature A\"],\n      \"length\": 3,\n      \"dimension\": \"complexity\"\n    }\n  ],\n  \"count\": 1,\n  \"message\": \"Found 1 logical inconsistencies\"\n}\n</code></pre></p> <p>Example Usage: <pre><code>curl -X GET \"http://localhost:8000/api/v1/projects/{id}/comparisons/inconsistencies?dimension=complexity\" \\\n  -H \"Authorization: Bearer {token}\"\n</code></pre></p>"},{"location":"inconsistency_detection/#get-projectsproject_idcomparisonsresolve-inconsistency","title":"GET <code>/projects/{project_id}/comparisons/resolve-inconsistency</code>","text":"<p>Suggests a comparison pair to help resolve detected inconsistencies.</p> <p>Strategy: Finds the \"weakest link\" in detected cycles - the comparison where the Bayesian model has highest combined uncertainty (\u03c3_i + \u03c3_j). Re-comparing this pair can help break the cycle.</p> <p>Parameters: - <code>dimension</code> (required): \"complexity\" or \"value\"</p> <p>Response: - <code>200 OK</code>: Returns a comparison pair to re-evaluate - <code>204 No Content</code>: No inconsistencies detected</p> <pre><code>{\n  \"comparison_id\": null,\n  \"feature_a\": { /* Feature object */ },\n  \"feature_b\": { /* Feature object */ },\n  \"dimension\": \"complexity\",\n  \"reason\": \"This pair is involved in a logical cycle and has high uncertainty...\",\n  \"combined_uncertainty\": 1.85\n}\n</code></pre>"},{"location":"inconsistency_detection/#ui-integration-strategy","title":"UI Integration Strategy","text":""},{"location":"inconsistency_detection/#hybrid-approach-embedded-stats-dedicated-endpoint","title":"Hybrid Approach: Embedded Stats + Dedicated Endpoint","text":"<p>The implementation uses a hybrid approach combining the benefits of both patterns:</p>"},{"location":"inconsistency_detection/#1-embedded-stats-post-comparisons-response","title":"1. Embedded Stats (POST <code>/comparisons</code> response)","text":"<p>When: After user submits a comparison Benefit: Immediate feedback without extra HTTP request</p> <pre><code>// Frontend: Submit comparison\nconst response = await api.createComparison(projectId, comparisonData);\n// Response includes inconsistency stats immediately\nupdateInconsistencyBadge(response.inconsistency_stats);\n</code></pre>"},{"location":"inconsistency_detection/#2-dedicated-endpoint-get-inconsistency-stats","title":"2. Dedicated Endpoint (GET <code>/inconsistency-stats</code>)","text":"<p>When:  - Dashboard loads - Polling/refresh without submitting comparisons - Health checks</p> <pre><code>// Frontend: Dashboard widget\nconst stats = await api.getInconsistencyStats(projectId, dimension);\ndisplayStats(stats.cycle_count, stats.inconsistency_percentage);\n</code></pre>"},{"location":"inconsistency_detection/#performance-characteristics","title":"Performance Characteristics","text":"<ul> <li>Calculation time: &lt; 1ms for 70 features</li> <li>Response overhead: ~50 bytes additional JSON</li> <li>Network impact: Eliminates one round-trip for common case</li> </ul>"},{"location":"inconsistency_detection/#ui-display-recommendations","title":"UI Display Recommendations","text":"<p>Inconsistency Badge: <pre><code>\u26a0\ufe0f 2 cycles (8.9% of comparisons)\n</code></pre></p> <p>Color Coding: - Green (0%): No inconsistencies - Yellow (&lt; 10%): Minor inconsistencies - Orange (10-20%): Moderate inconsistencies - Red (&gt; 20%): Significant inconsistencies</p> <p>When to Show: - After every comparison (updated automatically) - In project summary dashboard - Before exporting final rankings</p>"},{"location":"inconsistency_detection/#integration-with-bayesian-model","title":"Integration with Bayesian Model","text":"<p>The cycle detection complements the Bayesian Bradley-Terry model:</p> <ol> <li>Probabilistic Inconsistencies: Handled naturally by variance updates</li> <li>Model becomes less confident when it sees surprising outcomes</li> <li> <p>Variance (\u03c3) reflects this uncertainty</p> </li> <li> <p>Logical Inconsistencies: Detected by cycle algorithm</p> </li> <li>Hard cycles (A&gt;B&gt;C&gt;A) indicate potential user error or changing opinions</li> <li> <p>System suggests re-evaluating the most uncertain comparison in the cycle</p> </li> <li> <p>Resolution Strategy:</p> </li> <li>Identify cycles with <code>GET /inconsistencies</code></li> <li>Get weakest link with <code>GET /resolve-inconsistency</code></li> <li>Re-compare the suggested pair</li> <li>New comparison updates Bayesian scores and may break the cycle</li> </ol>"},{"location":"inconsistency_detection/#performance-characteristics_1","title":"Performance Characteristics","text":""},{"location":"inconsistency_detection/#scalability","title":"Scalability","text":"<ul> <li>70 features: &lt; 1ms detection time</li> <li>2,415 possible pairs: Worst case ~500-1000 actual comparisons</li> <li>Graph traversal: O(V + E) = O(70 + 500) = negligible</li> </ul>"},{"location":"inconsistency_detection/#memory-usage","title":"Memory Usage","text":"<ul> <li>Transient graph: Built in memory only during request</li> <li>No persistent storage: No database overhead</li> <li>Recursion stack: Max depth = cycle length (typically 3-5)</li> </ul>"},{"location":"inconsistency_detection/#when-to-check","title":"When to Check","text":"<ul> <li>After every 10-20 comparisons</li> <li>Before exporting final rankings</li> <li>When progress endpoint shows high variance despite many comparisons</li> <li>On user request via UI</li> </ul>"},{"location":"inconsistency_detection/#testing","title":"Testing","text":"<p>Comprehensive unit tests verify: - Simple 3-node cycles (A&gt;B&gt;C&gt;A) - Acyclic graphs (proper rankings) - Multiple independent cycles - Complex cycles with branches - Performance with 70-node graphs</p> <p>Run tests: <pre><code>pytest tests/test_cycle_detection.py -v\n</code></pre></p>"},{"location":"inconsistency_detection/#implementation-summary","title":"Implementation Summary","text":""},{"location":"inconsistency_detection/#endpoints-provided","title":"Endpoints Provided","text":"Endpoint Method Purpose Response Time <code>/comparisons</code> POST Create comparison + get stats &lt; 2ms <code>/comparisons/inconsistency-stats</code> GET Get stats only &lt; 1ms <code>/comparisons/inconsistencies</code> GET Get detailed cycles &lt; 1ms <code>/comparisons/resolve-inconsistency</code> GET Get resolution suggestion &lt; 1ms"},{"location":"inconsistency_detection/#data-flow","title":"Data Flow","text":"<pre><code>User submits comparison\n        \u2193\nPOST /comparisons\n        \u2193\n[Bayesian update] + [Stats calculation]\n        \u2193\nResponse with comparison + inconsistency_stats\n        \u2193\nUI updates badge: \"\u26a0\ufe0f 2 cycles (8.9%)\"\n</code></pre>"},{"location":"inconsistency_detection/#response-schema","title":"Response Schema","text":"<p>ComparisonWithStats: <pre><code>{\n  id: UUID,\n  project_id: UUID,\n  feature_a: Feature,\n  feature_b: Feature,\n  choice: \"feature_a\" | \"feature_b\" | \"tie\",\n  dimension: \"complexity\" | \"value\",\n  created_at: DateTime,\n  inconsistency_stats: {\n    cycle_count: number,          // Number of detected cycles\n    total_comparisons: number,    // Total comparisons for dimension\n    inconsistency_percentage: number,  // Percentage with 2 decimals\n    dimension: string             // \"complexity\", \"value\", or \"all\"\n  }\n}\n</code></pre></p>"},{"location":"inconsistency_detection/#performance-benchmarks","title":"Performance Benchmarks","text":"<ul> <li>70 features, 500 comparisons: &lt; 1ms cycle detection</li> <li>Response overhead: ~50 bytes JSON</li> <li>Memory usage: Transient (no persistent storage)</li> <li>Database impact: None (uses existing comparison data)</li> </ul>"},{"location":"inconsistency_detection/#future-enhancements","title":"Future Enhancements","text":"<p>Potential improvements (not currently needed): 1. Cycle severity scoring: Weight cycles by combined uncertainty 2. Transitive inconsistency detection: Check if A&gt;B&gt;C but model says A&lt;C 3. Cycle history tracking: Log when cycles appear/disappear 4. Batch resolution: Suggest multiple pairs to resolve all cycles efficiently 5. Redis caching: Cache stats for high-traffic projects (premature optimization) 6. WebSocket notifications: Real-time updates for collaborative sessions</p>"},{"location":"introduction/","title":"Introduction to Pairwise Comparison","text":""},{"location":"introduction/#the-challenge-of-prioritization","title":"The Challenge of Prioritization","text":"<p>In software development and product management, prioritizing features or requirements is a constant challenge. Stakeholders often struggle to assign absolute values (like \"High\", \"Medium\", \"Low\" or 1-10 scores) to a long list of items. This often leads to:</p> <ul> <li>The \"Everything is High Priority\" Syndrome: When everything is important, nothing is.</li> <li>Cognitive Overload: Comparing one item against an abstract scale is difficult and subjective.</li> <li>Inconsistency: A \"5\" today might be a \"7\" tomorrow depending on mood or context.</li> </ul>"},{"location":"introduction/#why-pairwise-comparison","title":"Why Pairwise Comparison?","text":"<p>Pairwise comparison simplifies this process by breaking it down into the smallest possible unit of decision-making: comparing two items against each other.</p> <p>Instead of asking \"How valuable is Feature A on a scale of 1 to 10?\", we ask: \"Is Feature A more valuable than Feature B?\"</p>"},{"location":"introduction/#cognitive-benefits","title":"Cognitive Benefits","text":"<ul> <li>Relative vs. Absolute Judgment: Humans are significantly better at making relative judgments (comparing A to B) than absolute judgments (rating A in isolation).</li> <li>Reduced Context Switching: The decision maker only needs to focus on two items at a time.</li> <li>Faster Decisions: Binary choices are quicker to make than nuanced scoring.</li> </ul>"},{"location":"introduction/#how-oneselect-works","title":"How OneSelect Works","text":"<p>OneSelect leverages the power of pairwise comparison but solves its main drawback: the number of comparisons.</p> <p>In a naive approach, comparing every item against every other item requires \\(O(N^2)\\) comparisons. For 50 features, that's 1,225 comparisons\u2014far too many for a human.</p> <p>OneSelect uses Bayesian Inference and Active Learning to:</p> <ol> <li>Select the most informative pairs: It chooses the pair of items that, if compared, will give the most information about the overall ranking (reducing uncertainty).</li> <li>Infer rankings: It updates the estimated score and confidence interval for every item after each comparison.</li> <li>Stop early: You don't need to compare everything. The system stops when it has enough certainty to rank the items reliably.</li> </ol> <p>This allows you to rank a large backlog with a fraction of the effort required for full manual sorting, while maintaining high mathematical rigor.</p>"},{"location":"introduction/#api-design-principles-for-ui-efficiency","title":"API Design Principles for UI Efficiency","text":"<p>The OneSelect API is designed with UI client efficiency in mind, minimizing round-trips and providing flexible data fetching patterns.</p>"},{"location":"introduction/#embedded-data-with-include_-parameters","title":"Embedded Data with <code>include_*</code> Parameters","text":"<p>Many endpoints support optional <code>include_*</code> query parameters that embed related data in the response, eliminating the need for separate API calls:</p> Endpoint Parameter Embeds <code>GET /projects</code> <code>include_stats=true</code> Feature counts, comparison counts, progress per dimension <code>GET /features</code> <code>include_scores=true</code> Bayesian scores (mu, sigma) for complexity and value <code>GET /comparisons/next</code> <code>include_progress=true</code> Current progress metrics toward target certainty <code>GET /results</code> <code>include_quadrants=true</code> Quadrant categorization alongside ranked results <p>Example - Efficient Dashboard Load: <pre><code>GET /api/v1/projects?include_stats=true\n</code></pre> Returns all projects with their statistics in a single call, rather than requiring N+1 requests.</p>"},{"location":"introduction/#inline-response-data","title":"Inline Response Data","text":"<p>Several mutation endpoints return updated state directly in the response, allowing immediate UI updates without refetching:</p> <ul> <li>Submit Comparison (<code>POST /comparisons</code>): Returns <code>inconsistency_stats</code> showing current cycle count and inconsistency percentage</li> <li>Undo Comparison (<code>POST /comparisons/undo</code>): Returns <code>updated_progress</code> with new comparison count and progress percentage</li> <li>Resolve Inconsistency (<code>GET /resolve-inconsistency</code>): Returns <code>cycle_context</code> with cycle count and affected feature names</li> </ul>"},{"location":"introduction/#batch-operations","title":"Batch Operations","text":"<p>For bulk data needs, the API supports batch fetching:</p> <pre><code>GET /api/v1/projects/{id}/comparisons?ids=uuid1,uuid2,uuid3\n</code></pre> <p>This retrieves specific comparisons by ID in a single request, useful for audit trails or undo history displays.</p>"},{"location":"introduction/#recommended-ui-patterns","title":"Recommended UI Patterns","text":"<ol> <li>Comparison Flow: Use <code>include_progress=true</code> on <code>/next</code> to show progress bar updates without extra calls</li> <li>Project List: Use <code>include_stats=true</code> to show feature counts and progress indicators on project cards</li> <li>Results View: Use <code>include_quadrants=true</code> to render both the ranked list and quadrant chart from one response</li> <li>Feature Table: Use <code>include_scores=true</code> when displaying uncertainty or confidence indicators</li> </ol>"},{"location":"introduction/#pagination-defaults","title":"Pagination Defaults","text":"<p>List endpoints use sensible defaults to balance payload size and usability: - Features: 50 per page - Comparisons: 20 per page - Projects: 100 per page</p> <p>For infinite scroll UIs, these can be adjusted via <code>per_page</code> or <code>limit</code> parameters.</p>"},{"location":"introduction/#audit-trail-and-data-integrity","title":"Audit Trail and Data Integrity","text":"<p>OneSelect maintains a complete audit trail of all comparison activity, ensuring transparency and enabling analysis of decision-making patterns.</p>"},{"location":"introduction/#what-is-tracked","title":"What is Tracked","text":"<p>Every comparison records: - Who: The user who made the comparison (<code>user_id</code>) - What: The features compared, the choice made, and the dimension - When: Timestamp of creation (<code>created_at</code>)</p> <p>For deleted or undone comparisons: - Deleted At: When the comparison was removed - Deleted By: Which user performed the deletion/undo</p>"},{"location":"introduction/#soft-deletes","title":"Soft Deletes","text":"<p>Comparisons are never permanently deleted from the database. Both explicit deletions and undo operations use soft deletes:</p> <pre><code>DELETE /api/v1/projects/{id}/comparisons/{comparison_id}  \u2192 Soft delete\nPOST /api/v1/projects/{id}/comparisons/undo               \u2192 Soft delete\n</code></pre> <p>This preserves the complete history of all decisions, including those later reconsidered.</p>"},{"location":"introduction/#accessing-the-audit-trail","title":"Accessing the Audit Trail","text":"<p>Use the project history endpoint to retrieve the full audit trail:</p> <pre><code>GET /api/v1/projects/{id}/history\n</code></pre> <p>Response: <pre><code>{\n  \"project\": { \"id\": \"...\", \"name\": \"...\" },\n  \"comparisons\": [\n    {\n      \"id\": \"uuid\",\n      \"feature_a\": { \"id\": \"...\", \"name\": \"Feature A\" },\n      \"feature_b\": { \"id\": \"...\", \"name\": \"Feature B\" },\n      \"choice\": \"feature_a\",\n      \"dimension\": \"complexity\",\n      \"user\": { \"id\": \"...\", \"username\": \"alice\" },\n      \"created_at\": \"2025-01-15T10:30:00Z\"\n    }\n  ],\n  \"deleted_comparisons\": [\n    {\n      \"id\": \"uuid\",\n      \"feature_a\": { \"id\": \"...\", \"name\": \"Feature C\" },\n      \"feature_b\": { \"id\": \"...\", \"name\": \"Feature D\" },\n      \"choice\": \"feature_b\",\n      \"dimension\": \"value\",\n      \"user\": { \"id\": \"...\", \"username\": \"alice\" },\n      \"created_at\": \"2025-01-15T09:00:00Z\",\n      \"deleted_at\": \"2025-01-15T11:00:00Z\",\n      \"deleted_by\": { \"id\": \"...\", \"username\": \"bob\" }\n    }\n  ]\n}\n</code></pre></p>"},{"location":"introduction/#use-cases-for-audit-trail","title":"Use Cases for Audit Trail","text":"<ol> <li>Compliance: Demonstrate how prioritization decisions were made</li> <li>Debugging Inconsistencies: Understand why certain cycles exist by reviewing comparison history</li> <li>User Activity Analysis: Track who contributed which comparisons</li> <li>Undo Analysis: See what was changed and by whom</li> <li>Data Recovery: Soft-deleted comparisons can potentially be restored if needed</li> </ol>"},{"location":"introduction/#authentication-and-security","title":"Authentication and Security","text":"<p>OneSelect uses industry-standard authentication mechanisms to protect your data and ensure secure access to the API.</p>"},{"location":"introduction/#jwt-tokens","title":"JWT Tokens","text":"<p>OneSelect uses JWT (JSON Web Token) for authentication. A JWT is a compact, URL-safe token that contains encoded claims about the user's identity and permissions.</p>"},{"location":"introduction/#what-is-a-jwt","title":"What is a JWT?","text":"<p>A JWT consists of three parts separated by dots (<code>.</code>):</p> <pre><code>header.payload.signature\n</code></pre> <ol> <li>Header: Contains metadata about the token type and signing algorithm</li> <li>Payload: Contains claims (user data, permissions, expiration time)</li> <li>Signature: Cryptographic signature to verify the token hasn't been tampered with</li> </ol> <p>Example JWT: <pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\n</code></pre></p>"},{"location":"introduction/#how-authentication-works","title":"How Authentication Works","text":"<ol> <li>Login: Send your credentials to <code>/api/v1/auth/login</code></li> <li>Receive Token: The API returns a JWT token</li> <li>Use Token: Include the token in the <code>Authorization</code> header for all subsequent requests:    <pre><code>Authorization: Bearer &lt;your-jwt-token&gt;\n</code></pre></li> <li>Token Expiration: Tokens expire after a set period (typically 24 hours). Use the refresh endpoint to get a new token without re-entering credentials.</li> </ol>"},{"location":"introduction/#security-benefits","title":"Security Benefits","text":"<ul> <li>Stateless: The server doesn't need to store session data</li> <li>Tamper-Proof: The cryptographic signature prevents token modification</li> <li>Self-Contained: All necessary information is encoded in the token</li> <li>Expiring: Tokens have a limited lifetime to reduce security risks</li> </ul>"},{"location":"introduction/#user-roles","title":"User Roles","text":"<p>OneSelect supports two user roles:</p> <ul> <li>User: Standard access to create projects and perform comparisons</li> <li>Root/Superuser: Administrative access including user management and system administration</li> </ul> <p>Role-based permissions ensure that sensitive operations are restricted to authorized users only.</p>"},{"location":"rest_api_spec_list/","title":"Appendix: API Endpoint List","text":"<p>Quick Reference Summary of All OneSelect API Endpoints</p> <p>This document provides a comprehensive list of all REST API endpoints in the OneSelect system. For detailed documentation with examples, see the API Reference.</p>"},{"location":"rest_api_spec_list/#base-url","title":"Base URL","text":"<p><code>https://api.oneselect.example.com/v1</code></p>"},{"location":"rest_api_spec_list/#common-data-types","title":"Common Data Types","text":"<ul> <li>UUID: String format uuid (e.g., <code>550e8400-e29b-41d4-a716-446655440000</code>).</li> <li>Dimension: Enum <code>[\"complexity\", \"value\"]</code>.</li> <li>ComparisonChoice: Enum <code>[\"feature_a\", \"feature_b\", \"tie\"]</code>.</li> <li>ComparisonMode: Enum <code>[\"binary\", \"graded\"]</code> - Project-level comparison mode.</li> <li>ComparisonStrength: Enum <code>[\"a_much_better\", \"a_better\", \"equal\", \"b_better\", \"b_much_better\"]</code> - 5-point scale for graded comparisons.</li> </ul>"},{"location":"rest_api_spec_list/#1-authentication-authorization","title":"1. Authentication &amp; Authorization","text":"<p>OneSelect supports two authentication methods: Username/Password (traditional) and Google OAuth (optional).</p>"},{"location":"rest_api_spec_list/#11-usernamepassword-authentication","title":"1.1 Username/Password Authentication","text":"ID Name Description Method Endpoint Parameters Responses AUTH-01 Login Authenticate a user and return a session token (JWT). <code>POST</code> <code>/auth/login</code> Body: <code>{ \"username\": \"string\", \"password\": \"string\" }</code> 200 OK: <code>{ \"access_token\": \"string\", \"token_type\": \"bearer\" }</code>401 Unauthorized AUTH-02 Register Register a new user (self-service sign-up). <code>POST</code> <code>/auth/register</code> Body: <code>{ \"username\": \"string\", \"password\": \"string\", \"email\": \"string\" }</code> 201 Created: <code>{ \"id\": \"uuid\", \"username\": \"string\", \"email\": \"string\", \"auth_provider\": \"local\" }</code>400 Bad Request AUTH-03 Refresh Token Refresh an expired JWT token using a refresh token. <code>POST</code> <code>/auth/refresh</code> Body: <code>{ \"refresh_token\": \"string\" }</code> 200 OK: <code>{ \"token\": \"string\", \"refresh_token\": \"string\" }</code>401 Unauthorized AUTH-04 Logout Invalidate the current session/token. <code>POST</code> <code>/auth/logout</code> None 204 No Content AUTH-05 Get Current User Get the profile of the currently authenticated user. <code>GET</code> <code>/auth/me</code> None 200 OK: <code>{ \"id\": \"uuid\", \"username\": \"string\", \"email\": \"string\", \"role\": \"string\", \"auth_provider\": \"local\" \\| \"google\" }</code> AUTH-06 Change Password Update the current user's password (local accounts only). <code>POST</code> <code>/auth/change-password</code> Body: <code>{ \"current_password\": \"string\", \"new_password\": \"string\" }</code> 204 No Content400 Bad Request (weak password or OAuth user)401 Unauthorized (wrong current password) AUTH-07 Update Profile Update mutable profile attributes for the current user. <code>PATCH</code> <code>/auth/me</code> Body: <code>{ \"email\": \"string\", \"display_name\": \"string\", \"avatar_url\": \"string\" }</code> 200 OK: <code>{ \"id\": \"uuid\", \"username\": \"string\", \"email\": \"string\", \"display_name\": \"string\", \"avatar_url\": \"string\" }</code> AUTH-08 Test Token Validate and test the current JWT token. <code>POST</code> <code>/auth/login/test-token</code> None 200 OK: <code>{ \"id\": \"uuid\", \"username\": \"string\", \"email\": \"string\", \"role\": \"string\" }</code>"},{"location":"rest_api_spec_list/#12-google-oauth-authentication","title":"1.2 Google OAuth Authentication","text":"ID Name Description Method Endpoint Parameters Responses AUTH-GOOGLE-01 Google Login Initiate Google OAuth flow. Redirects to Google's consent screen. <code>GET</code> <code>/auth/google/login</code> None 302 Redirect: To Google OAuth consent screen AUTH-GOOGLE-02 Google Callback Handle Google OAuth callback. Creates/links user account and redirects to frontend with JWT token. <code>GET</code> <code>/auth/google/callback</code> Query: <code>code</code> (OAuth code from Google), <code>state</code> (CSRF protection) 302 Redirect: <code>{FRONTEND_URL}/auth/callback?token=&lt;jwt_token&gt;</code> or <code>{FRONTEND_URL}/auth/error?message=&lt;error&gt;</code> AUTH-GOOGLE-03 OAuth Status Check if Google OAuth is configured and enabled. <code>GET</code> <code>/auth/google/status</code> None 200 OK: <code>{ \"google_oauth_enabled\": bool, \"google_client_id_set\": bool, \"google_client_secret_set\": bool }</code>"},{"location":"rest_api_spec_list/#2-user-management-rootadmin-only","title":"2. User Management (Root/Admin Only)","text":"<p>Note: Regular users can only see their own profile (implementation detail).</p> ID Name Description Method Endpoint Parameters Responses USER-01 List Users Get a list of all users. Root access required. <code>GET</code> <code>/users</code> None 200 OK: <code>[ { \"id\": \"uuid\", \"username\": \"string\", \"role\": \"string\" } ]</code>403 Forbidden USER-02 Assign Project Assign a project to a specific user. Root access required. <code>POST</code> <code>/users/{userId}/assignments</code> Path: <code>userId</code>Body: <code>{ \"projectId\": \"uuid\" }</code> 200 OK: <code>{ \"message\": \"Project assigned\" }</code>404 Not Found USER-03 Delete User Delete a user. Optionally transfer their projects to another user. Root access required. <code>DELETE</code> <code>/users/{userId}</code> Path: <code>userId</code>Query: <code>transfer_to</code> (optional uuid) 204 No Content404 Not Found USER-04 Update User Role Grant or revoke root access for a user. Root access required. <code>PATCH</code> <code>/users/{userId}/role</code> Path: <code>userId</code>Body: <code>{ \"role\": \"root\" \\| \"user\" }</code> 200 OK: <code>{ \"id\": \"uuid\", \"username\": \"string\", \"role\": \"string\" }</code>403 Forbidden USER-05 Get User Get details of a specific user. Root access required. <code>GET</code> <code>/users/{userId}</code> Path: <code>userId</code> 200 OK: <code>{ \"id\": \"uuid\", \"username\": \"string\", \"email\": \"string\", \"role\": \"string\", \"is_active\": bool }</code>404 Not Found USER-06 Update User Update user details. Root access required. <code>PUT</code> <code>/users/{userId}</code> Path: <code>userId</code>Body: <code>{ \"email\": \"string\", \"is_active\": bool }</code> 200 OK: <code>{ \"id\": \"uuid\", \"username\": \"string\", \"email\": \"string\", \"is_active\": bool }</code>404 Not Found USER-07 Update Own Profile Update the current user's own profile. <code>PUT</code> <code>/users/me</code> Body: <code>{ \"email\": \"string\", \"display_name\": \"string\" }</code> 200 OK: <code>{ \"id\": \"uuid\", \"username\": \"string\", \"email\": \"string\", \"display_name\": \"string\" }</code>"},{"location":"rest_api_spec_list/#3-project-management","title":"3. Project Management","text":"<p>Note: Users can only access projects they created or are assigned to.</p> ID Name Description Method Endpoint Parameters Responses PROJ-01 List Projects Get all projects visible to the current user. Supports <code>include_stats</code> for dashboard efficiency. <code>GET</code> <code>/projects</code> Query: <code>include_stats</code> (bool, optional, default false) - includes feature count, comparison counts, progress % per project 200 OK: <code>[ { \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\", \"created_at\": \"datetime\", \"stats\": { ... } (if include_stats=true) } ]</code> PROJ-02 Create Project Create a new project with optional comparison mode. <code>POST</code> <code>/projects</code> Body: <code>{ \"name\": \"string\", \"description\": \"string\", \"comparison_mode\": \"binary\" \\| \"graded\" (optional, default \"binary\") }</code> 201 Created: <code>{ \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\", \"comparison_mode\": \"binary\" \\| \"graded\", \"created_at\": \"datetime\" }</code> PROJ-03 Get Project Get details of a specific project. <code>GET</code> <code>/projects/{projectId}</code> Path: <code>projectId</code> 200 OK: <code>{ \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\", \"created_at\": \"datetime\" }</code>404 Not Found PROJ-04 Update Project Update project metadata. <code>PUT</code> <code>/projects/{projectId}</code> Path: <code>projectId</code>Body: <code>{ \"name\": \"string\", \"description\": \"string\" }</code> 200 OK: <code>{ \"id\": \"uuid\", \"name\": \"string\", ... }</code> PROJ-05 Delete Project Delete a project and all associated data. <code>DELETE</code> <code>/projects/{projectId}</code> Path: <code>projectId</code> 204 No Content PROJ-06 List User Projects Get all projects for a specific user. Root access required. <code>GET</code> <code>/users/{userId}/projects</code> Path: <code>userId</code> 200 OK: <code>[ { \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\", \"created_at\": \"datetime\" } ]</code>403 Forbidden PROJ-07 Get Project Summary Get a comprehensive project summary including stats, progress, and alerts in a single call. <code>GET</code> <code>/projects/{projectId}/summary</code> Path: <code>projectId</code> 200 OK: <code>{ \"project\": { \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\" }, \"feature_count\": int, \"comparisons\": { \"complexity\": { \"done\": int, \"remaining_for_95\": int }, \"value\": { \"done\": int, \"remaining_for_95\": int } }, \"average_variance\": { \"complexity\": float, \"value\": float }, \"inconsistency_count\": { \"complexity\": int, \"value\": int } }</code> PROJ-08 List Collaborators Get all users who have access to a project. <code>GET</code> <code>/projects/{projectId}/collaborators</code> Path: <code>projectId</code> 200 OK: <code>[ { \"user_id\": \"uuid\", \"username\": \"string\", \"role\": \"owner\" \\| \"collaborator\", \"assigned_at\": \"datetime\" } ]</code> PROJ-09 Get Activity Log Get paginated activity/audit log for a project. <code>GET</code> <code>/projects/{projectId}/activity</code> Path: <code>projectId</code>Query: <code>page</code> (int), <code>per_page</code> (int), <code>action_type</code> (optional) 200 OK: <code>{ \"items\": [ { \"id\": \"uuid\", \"user\": { \"id\": \"uuid\", \"username\": \"string\" }, \"action\": \"string\", \"entity_type\": \"string\", \"entity_id\": \"uuid\", \"timestamp\": \"datetime\", \"details\": {} } ], \"total\": int }</code> PROJ-10 Get Last Modified Get the last modification timestamp for cache invalidation. <code>GET</code> <code>/projects/{projectId}/last-modified</code> Path: <code>projectId</code> 200 OK: <code>{ \"last_modified\": \"datetime\", \"modified_by\": \"uuid\" }</code> PROJ-11 Get Comparison History Get complete audit trail of all comparisons made in a project, including active and deleted comparisons. <code>GET</code> <code>/projects/{projectId}/history</code> Path: <code>projectId</code> 200 OK: <code>{ \"project\": { \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\" }, \"comparisons\": [ { \"id\": \"uuid\", \"feature_a\": { \"id\": \"uuid\", \"name\": \"string\" }, \"feature_b\": { \"id\": \"uuid\", \"name\": \"string\" }, \"choice\": \"feature_a\" \\| \"feature_b\" \\| \"tie\", \"dimension\": \"complexity\" \\| \"value\", \"user\": { \"id\": \"uuid\", \"username\": \"string\" }, \"created_at\": \"datetime\" } ], \"deleted_comparisons\": [ { \"id\": \"uuid\", \"feature_a\": { \"id\": \"uuid\", \"name\": \"string\" }, \"feature_b\": { \"id\": \"uuid\", \"name\": \"string\" }, \"choice\": \"string\", \"dimension\": \"string\", \"user\": { \"id\": \"uuid\", \"username\": \"string\" }, \"created_at\": \"datetime\", \"deleted_at\": \"datetime\", \"deleted_by\": { \"id\": \"uuid\", \"username\": \"string\" } } ] }</code>"},{"location":"rest_api_spec_list/#4-feature-requirement-management","title":"4. Feature (Requirement) Management","text":"ID Name Description Method Endpoint Parameters Responses FEAT-01 List Features Get all features/requirements for a project. Supports <code>include_scores</code> for combined feature+score views. <code>GET</code> <code>/projects/{projectId}/features</code> Path: <code>projectId</code>Query: <code>page</code> (int, default 1), <code>per_page</code> (int, default 50), <code>search</code> (optional), <code>include_scores</code> (bool, optional, default false) - includes Bayesian mu/sigma scores 200 OK: <code>[ { \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\", \"scores\": { \"complexity\": { \"mu\": float, \"sigma\": float }, \"value\": { ... } } (if include_scores=true) } ]</code> FEAT-02 Add Feature Add a new feature to the project. Triggers recalculation of variance. <code>POST</code> <code>/projects/{projectId}/features</code> Path: <code>projectId</code>Body: <code>{ \"name\": \"string\", \"description\": \"string\" }</code> 201 Created: <code>{ \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\" }</code> FEAT-03 Bulk Add Features Add multiple features at once. <code>POST</code> <code>/projects/{projectId}/features/bulk</code> Path: <code>projectId</code>Body: <code>{ \"features\": [ { \"name\": \"string\", \"description\": \"string\" } ] }</code> 201 Created: <code>{ \"count\": int, \"ids\": [\"uuid\"] }</code> FEAT-04 Update Feature Update a feature's details. <code>PUT</code> <code>/projects/{projectId}/features/{featureId}</code> Path: <code>projectId</code>, <code>featureId</code>Body: <code>{ \"name\": \"string\", \"description\": \"string\" }</code> 200 OK: <code>{ \"id\": \"uuid\", ... }</code> FEAT-05 Delete Feature Remove a feature from the project. <code>DELETE</code> <code>/projects/{projectId}/features/{featureId}</code> Path: <code>projectId</code>, <code>featureId</code> 204 No Content FEAT-06 Bulk Delete Features Delete multiple features at once. <code>POST</code> <code>/projects/{projectId}/features/bulk-delete</code> Path: <code>projectId</code>Body: <code>{ \"feature_ids\": [\"uuid\"] }</code> 200 OK: <code>{ \"deleted_count\": int }</code> FEAT-07 Get Feature Get a single feature's details. <code>GET</code> <code>/projects/{projectId}/features/{featureId}</code> Path: <code>projectId</code>, <code>featureId</code> 200 OK: <code>{ \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\", \"tags\": [\"string\"], \"created_at\": \"datetime\", \"updated_at\": \"datetime\" }</code>"},{"location":"rest_api_spec_list/#5-comparison-handling","title":"5. Comparison Handling","text":"ID Name Description Method Endpoint Parameters Responses COMP-01 Get Next Pair Get the next pair of features to compare based on highest information gain using transitive closure optimization. Returns 204 when target certainty is reached or no useful comparisons remain. <code>GET</code> <code>/projects/{projectId}/comparisons/next</code> Path: <code>projectId</code>Query: <code>dimension</code> (enum: complexity, value), <code>target_certainty</code> (float, optional, default 0.0), <code>include_progress</code> (bool, optional) - When true, includes progress metrics in response 200 OK: <code>{ \"comparison_id\": null, \"feature_a\": { \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\" }, \"feature_b\": { \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\" }, \"dimension\": \"string\", \"progress\": { ... } (if include_progress=true) }</code>204 No Content (if target certainty reached or no useful comparisons left) COMP-02 Submit Result Submit the result of a pairwise comparison. Returns the comparison along with updated inconsistency statistics for immediate UI feedback. <code>POST</code> <code>/projects/{projectId}/comparisons</code> Path: <code>projectId</code>Body: <code>{ \"feature_a_id\": \"uuid\", \"feature_b_id\": \"uuid\", \"choice\": \"feature_a\" \\| \"feature_b\" \\| \"tie\", \"dimension\": \"complexity\" \\| \"value\" }</code> 201 Created: <code>{ \"id\": \"uuid\", \"project_id\": \"uuid\", \"feature_a\": { \"id\": \"uuid\", \"name\": \"string\" }, \"feature_b\": { \"id\": \"uuid\", \"name\": \"string\" }, \"choice\": \"string\", \"dimension\": \"string\", \"created_at\": \"datetime\", \"inconsistency_stats\": { \"cycle_count\": int, \"total_comparisons\": int, \"inconsistency_percentage\": float, \"dimension\": \"string\" } }</code> COMP-03 Get Estimates Get estimated number of comparisons needed to reach certainty thresholds. <code>GET</code> <code>/projects/{projectId}/comparisons/estimates</code> Path: <code>projectId</code>Query: <code>dimension</code> 200 OK: <code>{ \"dimension\": \"string\", \"estimates\": { \"70%\": int, \"80%\": int, \"90%\": int, \"95%\": int } }</code> COMP-04 Get Inconsistency Stats Get inconsistency statistics summary without full cycle details. Useful for dashboard widgets and health checks. <code>GET</code> <code>/projects/{projectId}/comparisons/inconsistency-stats</code> Path: <code>projectId</code>Query: <code>dimension</code> (optional) 200 OK: <code>{ \"cycle_count\": int, \"total_comparisons\": int, \"inconsistency_percentage\": float, \"dimension\": \"string\" }</code> COMP-04b Get Inconsistencies Get detailed graph cycles representing logical inconsistencies. Returns list of cycles with feature IDs and names. <code>GET</code> <code>/projects/{projectId}/comparisons/inconsistencies</code> Path: <code>projectId</code>Query: <code>dimension</code> (optional) 200 OK: <code>{ \"cycles\": [ { \"feature_ids\": [\"uuid\"], \"feature_names\": [\"string\"], \"length\": int, \"dimension\": \"string\" } ], \"count\": int, \"message\": \"string\" }</code> COMP-05 Delete Comparison Delete a specific comparison result (e.g., to resolve an inconsistency). <code>DELETE</code> <code>/projects/{projectId}/comparisons/{comparisonId}</code> Path: <code>projectId</code>, <code>comparisonId</code> 204 No Content COMP-06 Reset Comparisons Remove all comparisons for a project (or specific dimension) to start over. <code>POST</code> <code>/projects/{projectId}/comparisons/reset</code> Path: <code>projectId</code>Body: <code>{ \"dimension\": \"string\" (optional) }</code> 200 OK: <code>{ \"message\": \"Comparisons reset\", \"count\": int }</code> COMP-07 Get Resolution Pair Get a specific pair of features to compare to resolve a detected inconsistency. Identifies the \"weakest link\" in cycles (highest combined uncertainty). Includes cycle context with count and affected features. <code>GET</code> <code>/projects/{projectId}/comparisons/resolve-inconsistency</code> Path: <code>projectId</code>Query: <code>dimension</code> (required) 200 OK: <code>{ \"comparison_id\": null, \"feature_a\": { \"id\": \"uuid\", \"name\": \"string\", ... }, \"feature_b\": { \"id\": \"uuid\", \"name\": \"string\", ... }, \"dimension\": \"string\", \"reason\": \"string\", \"combined_uncertainty\": float, \"cycle_context\": { \"cycle_count\": int, \"features_in_cycles\": [\"string\", ...] } }</code>204 No Content (no inconsistencies detected) COMP-08 List Comparisons Get paginated history of past comparisons for audit/review. Supports batch fetch by IDs. <code>GET</code> <code>/projects/{projectId}/comparisons</code> Path: <code>projectId</code>Query: <code>dimension</code>, <code>page</code> (int), <code>per_page</code> (int), <code>ids</code> (comma-separated UUIDs, optional) - When provided, fetches specific comparisons by ID (ignores pagination) 200 OK: <code>{ \"items\": [ { \"id\": \"uuid\", \"feature_a\": { \"id\": \"uuid\", \"name\": \"string\" }, \"feature_b\": { \"id\": \"uuid\", \"name\": \"string\" }, \"choice\": \"string\", \"dimension\": \"string\", \"created_at\": \"datetime\" } ], \"total\": int, \"page\": int }</code> COMP-09 Get Comparison Progress Get current comparison progress as percentage toward target certainty using a hybrid confidence model (transitive coverage, Bayesian confidence, consistency). <code>GET</code> <code>/projects/{projectId}/comparisons/progress</code> Path: <code>projectId</code>Query: <code>dimension</code>, <code>target_certainty</code> (float, default 0.90) 200 OK: <code>{ \"dimension\": \"string\", \"target_certainty\": float, \"transitive_coverage\": float, \"effective_confidence\": float, \"progress_percent\": float, \"comparisons_done\": int, \"comparisons_remaining\": int, \"cycle_count\": int, ... }</code> (see api.md for full schema) COMP-10 Undo Last Comparison Undo the most recent comparison for a dimension. Returns updated progress for immediate UI feedback. <code>POST</code> <code>/projects/{projectId}/comparisons/undo</code> Path: <code>projectId</code>Body: <code>{ \"dimension\": \"string\" }</code> 200 OK: <code>{ \"undone_comparison_id\": \"uuid\", \"message\": \"Comparison undone\", \"updated_progress\": { \"comparisons_done\": int, \"progress_percent\": float } }</code>404 Not Found (if no comparisons to undo) COMP-11 Skip Comparison Skip a comparison pair if the user is unsure. The pair may be presented again later. <code>POST</code> <code>/projects/{projectId}/comparisons/skip</code> Path: <code>projectId</code>Body: <code>{ \"comparison_id\": \"uuid\" }</code> 200 OK: <code>{ \"status\": \"skipped\" }</code> COMP-12 Get Comparison Get details of a specific comparison. <code>GET</code> <code>/projects/{projectId}/comparisons/{comparisonId}</code> Path: <code>projectId</code>, <code>comparisonId</code> 200 OK: <code>{ \"id\": \"uuid\", \"feature_a\": { \"id\": \"uuid\", \"name\": \"string\" }, \"feature_b\": { \"id\": \"uuid\", \"name\": \"string\" }, \"choice\": \"string\", \"dimension\": \"string\", \"created_at\": \"datetime\" }</code>404 Not Found COMP-13 Update Comparison Update an existing comparison result. <code>PUT</code> <code>/projects/{projectId}/comparisons/{comparisonId}</code> Path: <code>projectId</code>, <code>comparisonId</code>Body: <code>{ \"choice\": \"feature_a\" \\| \"feature_b\" \\| \"tie\" }</code> 200 OK: <code>{ \"id\": \"uuid\", \"choice\": \"string\", \"updated_at\": \"datetime\" }</code>404 Not Found COMP-14 Submit Binary Comparison Submit a binary comparison (A beats B, B beats A, or tie). Only for projects in binary mode. <code>POST</code> <code>/projects/{projectId}/comparisons/binary</code> Path: <code>projectId</code>Body: <code>{ \"feature_a_id\": \"uuid\", \"feature_b_id\": \"uuid\", \"choice\": \"feature_a\" \\| \"feature_b\" \\| \"tie\", \"dimension\": \"complexity\" \\| \"value\" }</code> 201 Created: <code>{ \"id\": \"uuid\", \"project_id\": \"uuid\", \"feature_a\": { ... }, \"feature_b\": { ... }, \"choice\": \"string\", \"dimension\": \"string\", \"created_at\": \"datetime\", \"inconsistency_stats\": { ... } }</code>400 Bad Request (if project is in graded mode) COMP-15 Submit Graded Comparison Submit a graded comparison using a 5-point scale. Only for projects in graded mode. Graded comparisons provide more information per comparison, allowing faster convergence with 30-40% fewer total comparisons needed. <code>POST</code> <code>/projects/{projectId}/comparisons/graded</code> Path: <code>projectId</code>Body: <code>{ \"feature_a_id\": \"uuid\", \"feature_b_id\": \"uuid\", \"dimension\": \"complexity\" \\| \"value\", \"strength\": \"a_much_better\" \\| \"a_better\" \\| \"equal\" \\| \"b_better\" \\| \"b_much_better\" }</code> 201 Created: <code>{ \"id\": \"uuid\", \"project_id\": \"uuid\", \"feature_a\": { ... }, \"feature_b\": { ... }, \"dimension\": \"string\", \"strength\": \"string\", \"choice\": \"string\", \"created_at\": \"datetime\", \"inconsistency_stats\": { ... } }</code>400 Bad Request (if project is in binary mode)"},{"location":"rest_api_spec_list/#6-statistics-analysis","title":"6. Statistics &amp; Analysis","text":"ID Name Description Method Endpoint Parameters Responses STAT-01 Get Project Stats Get current state statistics including total comparisons, average variance, etc. <code>GET</code> <code>/projects/{projectId}/statistics</code> Path: <code>projectId</code> 200 OK: <code>{ \"total_features\": int, \"comparisons_count\": { \"complexity\": int, \"value\": int }, \"average_variance\": { \"complexity\": float, \"value\": float } }</code> STAT-02 Get Feature Scores Get raw scores and variance for all features. <code>GET</code> <code>/projects/{projectId}/statistics/scores</code> Path: <code>projectId</code> 200 OK: <code>[ { \"feature_id\": \"uuid\", \"name\": \"string\", \"complexity\": { \"mu\": float, \"sigma_sq\": float }, \"value\": { \"mu\": float, \"sigma_sq\": float } } ]</code>"},{"location":"rest_api_spec_list/#7-results","title":"7. Results","text":"ID Name Description Method Endpoint Parameters Responses RES-01 Get Ranked Results Get the final ranked list of features. Optionally includes quadrant analysis. <code>GET</code> <code>/projects/{projectId}/results</code> Path: <code>projectId</code>Query: <code>sort_by</code> (complexity, value, ratio), <code>include_quadrants</code> (bool, optional) - When true, includes quadrant categorization in response 200 OK: <code>[ { \"rank\": int, \"feature\": { \"id\": \"uuid\", \"name\": \"string\", \"description\": \"string\" }, \"score\": float, \"variance\": float, \"confidence_interval\": [float, float] } ]</code> or <code>{ \"results\": [...], \"quadrants\": { \"quick_wins\": [...], \"strategic\": [...], \"fill_ins\": [...], \"avoid\": [...] } }</code> (if include_quadrants=true) RES-02 Get Quadrant Analysis Get features categorized into four quadrants (Quick-Wins, Strategic, Fill-Ins, Avoid) based on complexity and value splits. <code>GET</code> <code>/projects/{projectId}/results/quadrants</code> Path: <code>projectId</code> 200 OK: <code>{ \"quick_wins\": [ { \"id\": \"uuid\", \"name\": \"string\" } ], \"strategic\": [...], \"fill_ins\": [...], \"avoid\": [...] }</code> RES-03 Export Results Export ranked results in various formats for reporting. <code>GET</code> <code>/projects/{projectId}/results/export</code> Path: <code>projectId</code>Query: <code>format</code> (enum: json, csv), <code>sort_by</code> (complexity, value, ratio) 200 OK: File download (CSV) or JSON array"},{"location":"rest_api_spec_list/#8-model-configuration-controls","title":"8. Model Configuration &amp; Controls","text":"ID Name Description Method Endpoint Parameters Responses MODEL-01 Get Model Config Retrieve the Bayesian/Thurstone-Mosteller configuration for a project, split per dimension. <code>GET</code> <code>/projects/{projectId}/model-config</code> Path: <code>projectId</code> 200 OK: <code>{ \"dimensions\": { \"complexity\": { \"prior_mean\": float, \"prior_variance\": float, \"logistic_scale\": float, \"tie_tolerance\": float, \"target_variance\": float }, \"value\": { ... } }, \"selection_strategy\": \"entropy\" \\| \"variance\", \"max_parallel_pairs\": int }</code> MODEL-02 Update Model Config Update configurable parameters that govern Bayesian updates (priors, tie tolerance, stopping variance). <code>PUT</code> <code>/projects/{projectId}/model-config</code> Path: <code>projectId</code>Body: <code>{ \"dimensions\": { \"complexity\": { \"prior_mean\": float, \"prior_variance\": float, \"logistic_scale\": float, \"target_variance\": float, \"tie_tolerance\": float } }, \"selection_strategy\": \"entropy\" \\| \"variance\", \"max_parallel_pairs\": int }</code> 200 OK: <code>{ \"message\": \"Model config updated\", \"effective_from\": \"datetime\" }</code>400 Bad Request (invalid ranges) MODEL-03 Preview Impact Simulate the expected comparison counts/variance using a draft configuration without persisting it. <code>POST</code> <code>/projects/{projectId}/model-config/preview</code> Path: <code>projectId</code>Body: <code>{ \"dimensions\": { ... } }</code> 200 OK: <code>{ \"complexity\": { \"expected_comparisons\": int, \"predicted_variance\": float }, \"value\": { ... } }</code> MODEL-04 Reset Model Config Reset the project's model configuration back to system defaults. <code>POST</code> <code>/projects/{projectId}/model-config/reset</code> Path: <code>projectId</code> 200 OK: <code>{ \"message\": \"Model config reset\", \"defaults\": { ... } }</code>"},{"location":"rest_api_spec_list/#9-database-administration-root-only","title":"9. Database Administration (Root Only)","text":"ID Name Description Method Endpoint Parameters Responses DB-01 Create Backup Create a full database backup. Root access required. <code>POST</code> <code>/admin/database/backup</code> None 200 OK: <code>{ \"backup_id\": \"uuid\", \"filename\": \"string\", \"size_bytes\": int, \"created_at\": \"datetime\" }</code> DB-02 List Backups Get all available database backups. Root access required. <code>GET</code> <code>/admin/database/backups</code> None 200 OK: <code>[ { \"backup_id\": \"uuid\", \"filename\": \"string\", \"size_bytes\": int, \"created_at\": \"datetime\" } ]</code> DB-03 Download Backup Download a specific backup file. Root access required. <code>GET</code> <code>/admin/database/backups/{backupId}</code> Path: <code>backupId</code> 200 OK: File download (SQLite database) DB-04 Restore Backup Restore database from a backup. Root access required. <code>POST</code> <code>/admin/database/restore</code> Body: <code>{ \"backup_id\": \"uuid\" }</code> 200 OK: <code>{ \"message\": \"Database restored\", \"restored_at\": \"datetime\" }</code>503 Service Unavailable (during restore) DB-05 Get Database Stats Get database health and size statistics. Root access required. <code>GET</code> <code>/admin/database/stats</code> None 200 OK: <code>{ \"size_bytes\": int, \"table_counts\": { \"users\": int, \"projects\": int, \"features\": int, \"comparisons\": int }, \"last_vacuum\": \"datetime\", \"integrity_ok\": bool }</code> DB-06 Run Maintenance Run database maintenance (VACUUM, integrity check). Root access required. <code>POST</code> <code>/admin/database/maintenance</code> Body: <code>{ \"operation\": \"vacuum\" \\| \"integrity_check\" \\| \"optimize\" }</code> 200 OK: <code>{ \"message\": \"Maintenance completed\", \"duration_ms\": int, \"details\": {} }</code> DB-07 Bulk Data Export Export all data for a project or entire system. Root access required. <code>GET</code> <code>/admin/database/export</code> Query: <code>project_id</code> (optional uuid), <code>format</code> (json | sql) 200 OK: File download (JSON or SQL dump) DB-08 Bulk Data Import Import data from a previous export. Root access required. <code>POST</code> <code>/admin/database/import</code> Body: Multipart file upload 200 OK: <code>{ \"message\": \"Import completed\", \"projects_imported\": int, \"features_imported\": int }</code>"},{"location":"theory_background/","title":"Theoretical Background","text":"<p>OneSelect uses a probabilistic model based on the Bradley-Terry model (a specific form of the Thurstone-Mosteller model) combined with Bayesian inference to estimate the relative value or complexity of features.</p>"},{"location":"theory_background/#the-core-model","title":"The Core Model","text":"<p>We assume that every feature \\(i\\) has a true, latent \"score\" \\(\\mu_i\\) on a given dimension (e.g., Value or Complexity). We cannot observe this score directly, but we can infer it through comparisons.</p>"},{"location":"theory_background/#the-probability-function","title":"The Probability Function","text":"<p>When we compare two features, \\(i\\) and \\(j\\), the probability that \\(i\\) wins (is chosen over \\(j\\)) is determined by the difference in their scores, modeled by the logistic function:</p> \\[ P(i &gt; j) = \\frac{1}{1 + e^{-\\frac{\\mu_i - \\mu_j}{s}}} \\] <p>Where: *   \\(\\mu_i, \\mu_j\\) are the latent scores of features \\(i\\) and \\(j\\). *   \\(s\\) is the Logistic Scale factor.</p> <p>This implies: *   If \\(\\mu_i = \\mu_j\\), \\(P(i &gt; j) = 0.5\\) (a toss-up). *   If \\(\\mu_i \\gg \\mu_j\\), \\(P(i &gt; j) \\to 1\\). *   If \\(\\mu_i \\ll \\mu_j\\), \\(P(i &gt; j) \\to 0\\).</p>"},{"location":"theory_background/#bayesian-inference","title":"Bayesian Inference","text":"<p>Instead of just keeping a single score for each feature, we model our belief about the score as a Gaussian (Normal) distribution:</p> \\[ \\mu_i \\sim \\mathcal{N}(\\hat{\\mu}_i, \\sigma^2_i) \\] <ul> <li>\\(\\hat{\\mu}_i\\): The current best estimate of the score (Mean).</li> <li>\\(\\sigma^2_i\\): The uncertainty about that score (Variance).</li> </ul>"},{"location":"theory_background/#initialization-priors","title":"Initialization (Priors)","text":"<p>Before any comparisons are made, we assign a Prior to every feature. *   Prior Mean (\\(\\mu_0\\)): Usually set to 0 or an arbitrary baseline (e.g., 25). *   Prior Variance (\\(\\sigma^2_0\\)): Set to a high value (e.g., 25 or 100) to represent that we are very uncertain about the true score.</p>"},{"location":"theory_background/#the-update-step","title":"The Update Step","text":"<p>When a user makes a choice (e.g., \"Feature A is more valuable than Feature B\"), we update the distributions for both features.</p> <ol> <li>Winner (A): The mean \\(\\hat{\\mu}_A\\) increases, and variance \\(\\sigma^2_A\\) decreases.</li> <li>Loser (B): The mean \\(\\hat{\\mu}_B\\) decreases, and variance \\(\\sigma^2_B\\) decreases.</li> </ol> <p>We use approximate Bayesian inference (specifically Expectation Propagation or Variational Inference techniques suitable for the Bradley-Terry model) to calculate the new posterior means and variances.</p>"},{"location":"theory_background/#active-learning-selecting-the-next-pair","title":"Active Learning: Selecting the Next Pair","text":"<p>To minimize the number of comparisons needed, OneSelect uses an Active Learning strategy combined with Transitive Inference. Instead of picking random pairs, it calculates which pair will provide the most Information Gain while leveraging transitivity to skip redundant comparisons.</p>"},{"location":"theory_background/#transitive-closure-optimization","title":"Transitive Closure Optimization","text":"<p>The key insight is that pairwise comparisons form a directed graph, and we can infer orderings through transitivity:</p> <ul> <li>If A &gt; B and B &gt; C, then we know A &gt; C without needing to ask.</li> <li>This reduces the required comparisons from O(N\u00b2) to approximately O(N log N).</li> </ul> <p>For N features: *   Na\u00efve approach: \\(N(N-1)/2\\) comparisons (e.g., 435 for 30 features) *   With transitivity: ~N \u00d7 log\u2082(N) comparisons (e.g., ~150 for 30 features) *   Theoretical minimum: \u2308log\u2082(N!)\u2309 (information-theoretic lower bound)</p>"},{"location":"theory_background/#selection-strategies","title":"Selection Strategies","text":"<p>The system uses a hybrid scoring approach that combines:</p> <ol> <li> <p>Traditional Active Learning (Uncertainty \u00d7 Closeness):     [     \\text{ActiveLearningScore}(i, j) = (\\sigma_i + \\sigma_j) \\cdot \\exp\\left(-\\frac{(\\hat{\\mu}_i - \\hat{\\mu}_j)^2}{2c^2}\\right)     ]     Where \\(c = 2.0\\) is a scaling factor. This prioritizes uncertain features with similar scores.</p> </li> <li> <p>Connectivity Bonus (for chain building):</p> <ul> <li>1.2\u00d7 if exactly one feature has prior comparisons (extends a chain)</li> <li>1.1\u00d7 if both features have prior comparisons (links existing knowledge)</li> <li>1.0\u00d7 if neither has comparisons (cold start)</li> </ul> </li> <li> <p>Transitive Filtering: Only considers pairs whose ordering is not already known via transitivity.</p> </li> </ol> <p>The final selection score is: [ \\text{SelectionScore}(i, j) = \\text{ActiveLearningScore}(i, j) \\times \\text{ConnectivityBonus} ]</p>"},{"location":"theory_background/#model-configuration-parameters","title":"Model Configuration Parameters","text":"<p>The API allows fine-tuning the mathematical model via the <code>model-config</code> endpoints. Here is what the parameters control:</p>"},{"location":"theory_background/#prior_mean","title":"<code>prior_mean</code>","text":"<ul> <li>Description: The starting score for all new features.</li> <li>Effect: Shifts the absolute scale of the results. Since the model is relative, this is mostly cosmetic, but keeping it consistent helps with visualization.</li> </ul>"},{"location":"theory_background/#prior_variance","title":"<code>prior_variance</code>","text":"<ul> <li>Description: The initial uncertainty assigned to a new feature.</li> <li>Effect: A higher value means the system is \"open-minded\" and will move the feature's score drastically after the first few comparisons. A lower value makes the score \"sticky\".</li> </ul>"},{"location":"theory_background/#logistic_scale-s","title":"<code>logistic_scale</code> (\\(s\\))","text":"<ul> <li>Description: Controls the \"steepness\" of the probability curve.</li> <li>Effect:<ul> <li>Small \\(s\\): The model assumes users are very precise. Small differences in score lead to high win probabilities.</li> <li>Large \\(s\\): The model assumes the comparison process is noisy. Even if \\(A\\) is much better than \\(B\\), there's still a chance the user might pick \\(B\\) by mistake or due to ambiguity.</li> <li>Tuning: If users feel the system is \"jumping to conclusions\" too fast, increase this value.</li> </ul> </li> </ul>"},{"location":"theory_background/#tie_tolerance","title":"<code>tie_tolerance</code>","text":"<ul> <li>Description: The probability mass assigned to a \"Tie\" outcome.</li> <li>Effect: In a strict Bradley-Terry model, ties are not natively supported. We handle ties by treating them as an observation that the difference \\(|\\mu_i - \\mu_j|\\) is smaller than some threshold \\(\\epsilon\\). This parameter defines that threshold width.</li> </ul>"},{"location":"theory_background/#target_variance","title":"<code>target_variance</code>","text":"<ul> <li>Description: Legacy stopping criterion based on Bayesian variance.</li> <li>Effect: Originally, the system considered the ranking \"complete\" when the average variance dropped below this threshold. Note: The current implementation primarily uses transitive coverage for determining completion (see Confidence Calculation below).</li> </ul>"},{"location":"theory_background/#max_parallel_pairs","title":"<code>max_parallel_pairs</code>","text":"<ul> <li>Description: For multi-user sessions, how many distinct pairs can be \"checked out\" for comparison simultaneously.</li> <li>Effect: Prevents race conditions where multiple users judge the exact same pair at the same time, which wastes effort.</li> </ul>"},{"location":"theory_background/#confidence-and-progress-calculation","title":"Confidence and Progress Calculation","text":"<p>The system uses a hybrid confidence model to determine progress and when comparisons are complete.</p>"},{"location":"theory_background/#key-metrics","title":"Key Metrics","text":"<ol> <li> <p>Direct Coverage: Fraction of pairs directly compared.     [     \\text{DirectCoverage} = \\frac{\\text{UniquePairsCompared}}{\\text{TotalPossiblePairs}}     ]</p> </li> <li> <p>Transitive Coverage: Fraction of pairs with known ordering (direct OR inferred via transitivity).     [     \\text{TransitiveCoverage} = \\frac{\\text{TotalPossiblePairs} - \\text{UncertainPairs}}{\\text{TotalPossiblePairs}}     ]</p> </li> <li> <p>Bayesian Confidence: Derived from variance reduction.     [     \\text{BayesianConfidence} = \\max(0, \\min(1, 1 - \\bar{\\sigma}))     ]     Where \\(\\bar{\\sigma}\\) is the average sigma across all features.</p> </li> <li> <p>Consistency Score: Penalizes logical cycles (inconsistencies).     [     \\text{ConsistencyScore} = \\max(0.5, 1 - \\frac{\\text{CycleCount}}{\\text{UniquePairsCompared}})     ]</p> </li> </ol>"},{"location":"theory_background/#effective-confidence-formula","title":"Effective Confidence Formula","text":"<p>The effective confidence determines overall progress:</p> <ul> <li> <p>If transitive coverage = 100% and no cycles:     [\\text{EffectiveConfidence} = 1.0]</p> </li> <li> <p>If transitive coverage = 100% but cycles exist:     [\\text{EffectiveConfidence} = \\min(0.95, \\text{ConsistencyScore})]</p> </li> <li> <p>Otherwise:     [\\text{EffectiveConfidence} = \\min(1, \\text{TransitiveCoverage} + 0.05 \\times \\text{BayesianConfidence}) \\times \\text{ConsistencyScore}]</p> </li> </ul>"},{"location":"theory_background/#practical-comparison-estimates","title":"Practical Comparison Estimates","text":"<p>For N features, the practical number of comparisons needed is approximately: [ \\text{PracticalEstimate} \\approx (0.5 + 0.3 \\times \\text{TargetCertainty}) \\times N \\times \\log_2(N) ]</p> Features 70% Target 80% Target 90% Target Theoretical Min 10 24 27 29 22 20 61 67 73 62 30 105 115 125 107 50 198 217 236 214"},{"location":"theory_background/#theoretical-foundation-the-bayesian-thurstone-mosteller-model","title":"Theoretical Foundation: The Bayesian Thurstone-Mosteller Model","text":"<p>The core model we'll use is a Bayesian interpretation of the Bradley-Terry model (for pairwise comparisons) or, more generally, the Thurstone-Mosteller model. It assumes that each feature has an underlying, unobserved \"score\" (for complexity or value), and the outcome of a pairwise comparison is a probabilistic function of the difference between these scores.</p> <p>Core Assumptions:</p> <ol> <li>Latent Score: Every feature \\(i\\) has a true, but unknown, latent score \\(\\mu_i\\) for the dimension being rated (complexity or value).</li> <li>Comparison Probability: The probability that feature \\(i\\) is chosen as \"more complex/valuable\" than feature \\(j\\) is given by the cumulative distribution function of the difference in their scores. A common and mathematically convenient choice is the Logistic Function (leading to the Bradley-Terry model):     [     P(i &gt; j) = \\frac{1}{1 + e^{-(\\mu_i - \\mu_j)}}     ]     Here, \\(\\mu_i - \\mu_j\\) is the score difference. If \\(\\mu_i = \\mu_j\\), the probability is 0.5 (a toss-up). As \\(\\mu_i\\) becomes much larger than \\(\\mu_j\\), the probability approaches 1.</li> <li>Prior Distribution: We start with a prior belief about each feature's score. A natural choice is a Normal (Gaussian) distribution because it is conjugate to itself when updated with normal likelihoods, making the math tractable. We represent our belief about feature \\(i\\)'s score as:     [     \\mu_i \\sim \\mathcal{N}(\\hat{\\mu}_i, \\sigma^2_i)     ]     where:<ul> <li>\\(\\hat{\\mu}_i\\) is our current mean estimate of the score.</li> <li>\\(\\sigma^2_i\\) is the variance, representing our uncertainty about the estimate.</li> </ul> </li> </ol>"},{"location":"theory_background/#initialization","title":"Initialization","text":"<p>At the start of your meeting, before any comparisons are made:</p> <ol> <li>Set Prior Means (\\(\\hat{\\mu}_i\\)): You can set all prior means to 0. This assumes no prior knowledge about which features are more complex/valuable. Alternatively, if you have a rough gut feeling, you could assign initial values, but 0 is standard and unbiased.</li> <li>Set Prior Variances (\\(\\sigma^2_i\\)): Set all initial variances to a relatively high value, e.g., 1.0. A high initial variance means we are very uncertain about our initial estimates and are ready to update them significantly based on new data.</li> </ol>"},{"location":"theory_background/#the-bayesian-update-step","title":"The Bayesian Update Step","text":"<p>This is the core of the learning process. After each pairwise comparison between feature \\(i\\) and feature \\(j\\), we update our beliefs about their scores.</p> <p>Let's say we compare feature \\(i\\) vs. \\(j\\). The possible outcomes are: *   Outcome \\(y=1\\): Feature \\(i\\) is chosen. *   Outcome \\(y=0\\): Feature \\(j\\) is chosen.</p> <p>We treat the outcome as a binary observation.</p> <p>The update is performed using a method called \"Assumed Density Filtering\" (ADF) or Laplace Approximation. The goal is to find a new Gaussian distribution for \\(\\mu_i\\) and \\(\\mu_j\\) that best matches the true, but more complex, posterior distribution. The steps are:</p> <ol> <li> <p>Compute Expected Outcome: Based on our current beliefs, what was the expected probability that \\(i\\) would win?     [     \\hat{p} = E[P(i&gt;j)] = \\int \\int \\frac{1}{1 + e^{-(x_i - x_j)}} \\mathcal{N}(x_i | \\hat{\\mu}_i, \\sigma^2_i) \\mathcal{N}(x_j | \\hat{\\mu}_j, \\sigma^2_j) dx_i dx_j     ]     This integral is tricky, but it can be approximated very well by:     [     \\hat{p} \\approx \\frac{1}{1 + e^{-(\\hat{\\mu}_i - \\hat{\\mu}_j) / \\sqrt{1 + \\bar{\\sigma}^2}}}     ]     where \\(\\bar{\\sigma}^2\\) is a mean variance. A simpler and effective approximation is \\(\\hat{p} = \\frac{1}{1 + e^{-(\\hat{\\mu}_i - \\hat{\\mu}_j)}}\\), treating the current scores as certain for the purpose of prediction.</p> </li> <li> <p>Compute Prediction Error: The difference between the actual outcome and the expected outcome.     [     \\delta = y - \\hat{p}     ]</p> </li> <li> <p>Calculate the Update (Gradient and Hessian): We compute the derivative (gradient) and second derivative (Hessian) of the log-likelihood with respect to the scores. For the logistic model, this leads to a simple update rule. The variance of the outcome is (\\hat{p}(1-\\hat{p})$.</p> </li> <li> <p>Update the Means and Variances: The parameters for features \\(i\\) and \\(j\\) are updated as follows:     [     \\hat{\\mu}_i \\leftarrow \\hat{\\mu}_i + \\sigma^2_i \\cdot \\frac{\\delta}{\\sqrt{1 + \\lambda \\hat{p}(1-\\hat{p})}}     ]     [     \\hat{\\mu}_j \\leftarrow \\hat{\\mu}_j - \\sigma^2_j \\cdot \\frac{\\delta}{\\sqrt{1 + \\lambda \\hat{p}(1-\\hat{p})}}     ]     [     \\sigma^2_i \\leftarrow \\sigma^2_i \\cdot \\max\\left(1 - \\sigma^2_i \\cdot \\frac{\\hat{p}(1-\\hat{p})}{1 + \\lambda \\hat{p}(1-\\hat{p})}, \\kappa \\right)     ]     [     \\sigma^2_j \\leftarrow \\sigma^2_j \\cdot \\max\\left(1 - \\sigma^2_j \\cdot \\frac{\\hat{p}(1-\\hat{p})}{1 + \\lambda \\hat{p}(1-\\hat{p})}, \\kappa \\right)     ]     Where:</p> <ul> <li>\\(\\lambda\\) is a tuning parameter (often set to \\(\\pi/8\\) or 1 for the logistic model).</li> <li>\\(\\kappa\\) is a small minimum variance (e.g., 0.01) to prevent overconfidence and allow for continued learning.</li> </ul> </li> </ol> <p>Interpretation: *   Mean Update: If \\(i\\) wins (\\(y=1\\)) and we expected it to (\\(\\hat{p} &gt; 0.5\\)), the update is positive but small. If it wins and we were uncertain (\\(\\hat{p} \\approx 0.5\\)), the update is large. The update is scaled by the feature's current uncertainty (\\(\\sigma^2_i\\))\u2014we learn more about features we are uncertain of. *   Variance Update: After each comparison, the variances of the compared features shrink. We become more confident in our estimates.</p>"},{"location":"theory_background/#active-selection-of-the-next-comparison","title":"Active Selection of the Next Comparison","text":"<p>This is the \"smart\" part. Instead of picking comparisons randomly, we choose the pair that provides the maximum expected information gain. A standard and effective metric for this is the Expected Information Gain, which, for a Gaussian approximation, is closely related to the expected reduction in variance.</p> <p>A simpler, highly effective, and computationally cheap heuristic is to pick the pair \\((i, j)\\) that maximizes the product of two terms:</p> \\[ \\text{Selection Score}(i, j) = \\text{Uncertainty}(i, j) \\cdot \\text{Closeness}(i, j) \\] <p>Where: *   Uncertainty: \\(\\sigma_i + \\sigma_j\\). We want to compare features we are uncertain about. *   Closeness: \\(1 - |\\hat{p} - 0.5|\\), where \\(\\hat{p}\\) is the estimated probability that \\(i\\) beats \\(j\\). This term is maximized when \\(\\hat{p}\\) is near 0.5, meaning the outcome is most unpredictable and therefore most informative.</p> <p>In practice, you can simply compute: [ \\text{Selection Score}(i, j) = (\\sigma_i + \\sigma_j) \\cdot \\exp\\left(-\\frac{(\\hat{\\mu}_i - \\hat{\\mu}_j)^2}{2c^2}\\right) ] where \\(c\\) is a scaling factor. The pair with the highest score is chosen for the next comparison.</p>"},{"location":"theory_background/#practical-workflow-for-your-meetings","title":"Practical Workflow for Your Meetings","text":"<ol> <li> <p>Preparation: Input all features into a tool (a simple script or web app is ideal for this). Initialize all scores \\(\\hat{\\mu}_i = 0\\) and variances \\(\\sigma^2_i = 1.0\\).</p> </li> <li> <p>Meeting Loop:     a. The tool uses the active selection algorithm to present the most informative pair: \"Which is more complex, Feature A or Feature B?\"     b. The technical architects vote/discuss and provide their answer.     c. The facilitator inputs the result into the tool.     d. The tool performs the Bayesian update for features A and B, adjusting their scores and uncertainties.     e. Repeat. The tool might show a live ranking list (ordered by current mean score \\(\\hat{\\mu}_i\\)) with confidence intervals (e.g., \\(\\hat{\\mu}_i \\pm 2\\sigma_i\\)).</p> </li> <li> <p>Stopping Condition: The system stops requesting comparisons when any of these conditions are met:</p> <ul> <li>Transitive coverage reaches target: All (or target percentage of) pair orderings are known via direct comparison or transitivity.</li> <li>No uncertain pairs remain: Every pair's ordering can be determined from existing comparisons.</li> <li>Cycles detected: If inconsistencies exist, the system offers resolution pairs instead.</li> <li>A timebox expires (e.g., 60 minutes) - application-level control.</li> </ul> <p>The <code>/next</code> endpoint returns HTTP 204 No Content when comparisons are complete.</p> </li> <li> <p>Handling Inconsistencies:</p> <ul> <li>The model automatically handles minor inconsistencies because it's probabilistic. A single \"upset\" (a lower-rated feature winning) will not drastically change the rankings but will slightly increase the uncertainty of the involved features.</li> <li>Flagging Major Inconsistencies: At the end of the meeting, the tool can identify pairs where the model's prediction was most wrong. It can report: \"We observed a potential inconsistency: you rated A &gt; B, B &gt; C, but C &gt; A. Let's re-examine this triplet.\"</li> <li>You can then force a comparison between the most conflicting pair in this triplet to resolve the inconsistency directly.</li> </ul> </li> </ol>"},{"location":"theory_background/#output-and-final-ranking","title":"Output and Final Ranking","text":"<p>At the end of the session, you have for each feature \\(i\\): *   A mean score \\(\\hat{\\mu}_i\\), which gives you the final rank. *   A standard deviation \\(\\sigma_i\\), which quantifies your confidence.</p> <p>You can then plot the features on a 2x2 matrix (Business Value vs. Technical Complexity), where each feature is not a point but an ellipse, representing the uncertainty in both dimensions. This visually communicates that the ranking is probabilistic.</p>"},{"location":"working-with-proxies/","title":"Working Behind Corporate Proxies","text":"<p>This guide helps developers working behind corporate proxies or using PyPI mirrors/caches.</p>"},{"location":"working-with-proxies/#poetry-with-custom-pypi-sources","title":"Poetry with Custom PyPI Sources","text":"<p>If your organization uses a PyPI mirror (Artifactory, Nexus, etc.), configure Poetry to use it:</p>"},{"location":"working-with-proxies/#add-custom-source","title":"Add Custom Source","text":"<pre><code>poetry source add --priority=primary &lt;source-name&gt; &lt;source-url&gt;\n</code></pre> <p>Example with Artifactory: <pre><code>poetry source add --priority=primary artifactory \\\n  https://your-artifactory.com/artifactory/api/pypi/pypi-virtual/simple\n</code></pre></p> <p>Example with Nexus: <pre><code>poetry source add --priority=primary nexus \\\n  https://your-nexus.com/repository/pypi-proxy/simple\n</code></pre></p>"},{"location":"working-with-proxies/#verify-configuration","title":"Verify Configuration","text":"<pre><code>poetry source show\n</code></pre>"},{"location":"working-with-proxies/#set-proxy-environment-variables","title":"Set Proxy Environment Variables","text":"<p>If you need an HTTP proxy:</p> <pre><code>export https_proxy=http://proxy.company.com:8080\nexport http_proxy=http://proxy.company.com:8080\n</code></pre> <p>Add to <code>~/.zshrc</code> or <code>~/.bashrc</code> to make permanent: <pre><code>echo 'export https_proxy=http://proxy.company.com:8080' &gt;&gt; ~/.zshrc\necho 'export http_proxy=http://proxy.company.com:8080' &gt;&gt; ~/.zshrc\nsource ~/.zshrc\n</code></pre></p>"},{"location":"working-with-proxies/#configuration-persistence","title":"Configuration Persistence","text":"<p>Your Poetry source configuration is stored in: - Project-level: <code>pyproject.toml</code> (not recommended for company-specific URLs) - User-level: <code>~/.config/pypoetry/config.toml</code> (recommended)</p> <p>The <code>poetry source add</code> command stores configuration at the project level by default, adding it to <code>pyproject.toml</code>. </p> <p>To keep company-specific URLs out of the repository, you have two options:</p>"},{"location":"working-with-proxies/#option-1-manual-configuration-recommended","title":"Option 1: Manual Configuration (Recommended)","text":"<p>Each developer runs the <code>poetry source add</code> command locally. The source is added to <code>pyproject.toml</code> but should be in <code>.gitignore</code> or manually excluded from commits.</p>"},{"location":"working-with-proxies/#option-2-global-poetry-configuration","title":"Option 2: Global Poetry Configuration","text":"<p>Configure default sources globally:</p> <pre><code># Edit Poetry's global config\npoetry config repositories.artifactory https://your-artifactory.com/...\npoetry config http-basic.artifactory &lt;username&gt; &lt;password&gt;\n</code></pre> <p>Or manually edit <code>~/.config/pypoetry/config.toml</code>:</p> <pre><code># ~/.config/pypoetry/config.toml\n\n[repositories.artifactory]\nurl = \"https://your-artifactory.com/artifactory/api/pypi/mme-pypi-virtual/simple\"\n\n[http-basic.artifactory]\nusername = \"your-username\"\npassword = \"your-password\"\n\n# Optional: Set as default source\n[installer]\nparallel = true\n\n[virtualenvs]\nin-project = true\n</code></pre> <p>After editing, verify with: <pre><code>poetry config --list\n</code></pre></p>"},{"location":"working-with-proxies/#using-pips-configuration","title":"Using pip's Configuration","text":"<p>Poetry doesn't automatically read pip's configuration (<code>~/.pip/pip.conf</code>). If you have pip configured, you must separately configure Poetry as shown above.</p>"},{"location":"working-with-proxies/#troubleshooting","title":"Troubleshooting","text":""},{"location":"working-with-proxies/#poetry-cant-connect-to-pypi","title":"Poetry can't connect to PyPI","text":"<p>Symptom: <code>All attempts to connect to pypi.org failed</code></p> <p>Solution: 1. Verify proxy environment variables are set 2. Add your PyPI mirror as primary source 3. Test with <code>poetry lock -vv</code> to see connection attempts</p>"},{"location":"working-with-proxies/#certificate-errors","title":"Certificate Errors","text":"<p>Symptom: SSL certificate verification failed</p> <p>Solution: <pre><code># Disable SSL verification (not recommended for production)\npoetry config certificates.&lt;source-name&gt;.cert false\n\n# Or provide custom CA bundle\nexport REQUESTS_CA_BUNDLE=/path/to/ca-bundle.crt\n</code></pre></p>"},{"location":"working-with-proxies/#authentication-required","title":"Authentication Required","text":"<p>If your PyPI mirror requires authentication:</p> <pre><code>poetry config http-basic.&lt;source-name&gt; &lt;username&gt; &lt;password&gt;\n\n# Or use tokens\npoetry config pypi-token.&lt;source-name&gt; &lt;token&gt;\n</code></pre>"},{"location":"working-with-proxies/#gitignore-entry","title":".gitignore Entry","text":"<p>To prevent accidental commits of source configuration, ensure your <code>.gitignore</code> includes:</p> <pre><code># Poetry source configuration (company-specific)\n# Remove [[tool.poetry.source]] sections before committing if added\n</code></pre> <p>Or manually review <code>pyproject.toml</code> before committing to ensure no company-specific URLs are included.</p>"},{"location":"working-with-proxies/#example-workflow","title":"Example Workflow","text":"<pre><code># 1. Clone repository\ngit clone https://github.com/johan162/oneselect.git\ncd oneselect\n\n# 2. Configure proxy (if needed)\nexport https_proxy=http://localhost:9000\n\n# 3. Add PyPI mirror (if needed)\npoetry source add --priority=primary artifactory \\\n  https://your-mirror.com/api/pypi/pypi-virtual/simple\n\n# 4. Lock and install dependencies\npoetry lock\npoetry install\n\n# 5. Before committing changes to pyproject.toml\n# Remove any [[tool.poetry.source]] sections that were added\n</code></pre>"},{"location":"working-with-proxies/#cicd-considerations","title":"CI/CD Considerations","text":"<p>For CI/CD pipelines that run outside your corporate network: - Use environment variables for proxy configuration - Don't commit source URLs to the repository - Configure CI/CD to use public PyPI - Or maintain separate <code>pyproject.toml</code> for internal/external builds</p> <p>Note: This guide is for development setup only. The OneSelect application itself does not require any special proxy configuration at runtime.</p>"}]}